var lastClickedAutocompleter=null;var adding=false;var globalAddingConnection=false;var validationRulesLoaded=false;var menuVisible=false;var myCKEditor=null;var tabActiveGlobal=true;var checkingIframeInstalled=false;var unsavedTopicChanges=false;var unsavedSubmitClicked=false;(function($){$.fn.inputFilter=function(inputFilter){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){if(inputFilter(this.value)){this.oldValue=this.value;this.oldSelectionStart=this.selectionStart;this.oldSelectionEnd=this.selectionEnd}else if(this.hasOwnProperty("oldValue")){this.value=this.oldValue;this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)}else{this.value=""}})}})(jQuery);installGlobalTooltips();$(function(){$(document).on("click","input.item_autocompleter",function(){if($(this).attr("id")!="tournamentTypeAutocompleter"){lastClickedAutocompleter=$(this)}});$(document).on("click",".delete_item, .reject_item, .delete-item-new",function(event){if($(this).hasClass("only-logged")&&userId=="0"){if($(this).data("only-logged-msg")){showUnloggedInfo($(this).data("only-logged-msg"))}else{showUnloggedInfo(vblang("logged.add_something"))}return false}var editedElement=$(this).closest("div.ajax-edited-element");if(!userA&&editedElement.data("author-id")&&editedElement.data("author-id")!=userId&&userP!=$(".item-profile").data("id")){addUniversalDialog("deleting_item_dialog",vblang("dialog.delete"),true,null,false);createUniversalDialogLoadContent("deleting_item_dialog",{url:$(this).attr("href")},"get_deleting_item_dialog");return false}else{return confirmRedirect(vblang("confirm.sure"),event)}});$(document).on("click",".autocomplete-pointer",function(){var autocompleter$=$(this).closest("div.autocomplete-item-suggestions").find(".item_autocompleter");autocompleter$.focus();autocompleter$.autocomplete("search")});$(document).on("click","div.ajax-edited-element .edit_icon",function(){if($(this).hasClass("only-logged")&&userId=="0"){if($(this).data("only-logged-msg")){showUnloggedInfo($(this).data("only-logged-msg"))}else{showUnloggedInfo(vblang("logged.add_something"))}return false}stdBtnChangeContent("edit");var edited_element=$(this).closest("div.ajax-edited-element");$("div.ajax-edited-element").show();$(".add_connection_cnt .item_autocompleter, #edit_confirmation").css("border-color","");var add_connection_cnt=$(".add_connection_cnt");add_connection_cnt.find("p.errors").remove();edited_element.hide();add_connection_cnt.insertBefore(edited_element);add_connection_cnt.show();edited_element.find("input[data-edited-element-field]").each(function(){var editedElemendField=$(this).data("edited-element-field");$(".add_connection_cnt").find(editedElemendField).val($(this).val())});add_connection_cnt.trigger("shown");var edit_confirmation=$("#edit_confirmation");if(!userA&&edited_element.data("author-id")&&userP!=$(".item-profile").data("id")&&add_connection_cnt.data("isa")!=1){if(edit_confirmation.length>0){edit_confirmation.show()}else{var $textarea=$("<textarea />");$textarea.attr("name","edit_confirmation");$textarea.attr("id","edit_confirmation");$textarea.attr("maxlength","200");$textarea.attr("rows","2");$textarea.attr("placeholder",vblang("placeholder.proof"));$textarea.addClass("marginTop5");$textarea.addClass("new_input");$textarea.insertBefore($(".add_connection_cnt #submit_button_hall").closest("div"))}}else{edit_confirmation.hide()}});$(document).on("click","#cancel_button_hall",function(){$(".addClubBox").show();$(".ajax-edited-element").show();$(".add_connection_cnt").hide()});tabsSetup();installCloseDialogButton();if(isMobile=="true"){installMobileMenu()}else{installFixedElement($(".scrolled-advertise"),"fixed-advertise",false,null);online_setup(userId!="0");installOtherSubdomains();var searchItem$=$("#searchItem");searchItem$.on("selectedItemEvent",function(event,additionalData){if(additionalData){window.location=additionalData}});searchItem$.on("click select",function(){if($(".ui-widget-overlay-search").length<1){$("header.page-header .section-top-inner").prepend('<div class="ui-widget-overlay ui-front ui-widget-overlay-search" style="display: none;"></div>');$(".ui-widget-overlay-search").fadeIn(2600);if($("body").hasClass("dark-skin")){$(".search_ajax_autocomplete input").css("color","#000").css("background-color","#fff")}}});searchItem$.keyup(function(e){if(e.key==="Escape"){escapeSearchItem()}});$(".search_ajax_autocomplete").on("click",function(e){if($(e.target).attr("id")!="searchItem"){searchItem$.trigger("focus")}})}addAutocompleteTriggers();$("#searchItem,#itemSearchMobile").on("focus",function(e){$(this).one("mouseup",function(){$(this).select();return false}).select()});const images=$(".image-load-container.own-picture");if(images.length>0){showVisibleImages(images);$(document).scroll(function(){showVisibleImages(images)})}if(userId!="0"){msg_actions_cnt_setup();installInboxAjax();installActionsAjax()}installMenuLoginWindow();installMenuCategories();showInfoErrorDialogs();installBrowserFocus();installShowingAddWallpaper();installAjaxScrolledContent();installProfileLeftSlideBox();installTerm();installEditItemInfo();installShowingBigProfilImages();installProfileHeader();frameTriggerEvents();installSaveItemObserver();installAllHorizontallScrolls();installModeSwitcher();installGenderSwitcher();installKeypressHandlers()});function installKeypressHandlers(){$(document).on("keydown",function(event){if(event.key==="Escape"){if($("#image-overlay").length){$("#image-overlay").removeClass("open")}}})}function initValidationRulesGlobal(){if(!validationRulesLoaded){initValidationRules();validationRulesLoaded=true}}function installGenderSwitcher(){$("#gender_switcher").change(function(){var link="";var subpage=$(this).data("subpage")==""?$("body").data("url"):$(this).data("subpage");if($(this).val()=="M"){link=basedirMen+subpage}else if($(this).val()=="W"){link=basedirWomen+subpage}else if($(this).val()=="B"){link=basedirBeach+subpage}if(link){window.location.replace(link)}})}function installModeSwitcher(){$("#global_dark_mode").change(function(){var dark_mode=$(this).is(":checked")?"1":"0";if(dark_mode=="1"){$("body").removeClass("light-skin").addClass("dark-skin")}else{$("body").removeClass("dark-skin").addClass("light-skin")}$.ajax({type:"POST",data:{dark_mode:dark_mode},url:basedir+"ajax/update_website_mode",success:function(data){}})})}function installSaveItemObserver(){var savingItemObserver=false;$(document).on("click",".save-item-observer-btn",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.follow"))}else{if(!savingItemObserver){savingItemObserver=true;var btn=$(this);$.ajax({type:"POST",dataType:"json",url:basedir+"ajax/save_item_observer",data:{item_type:btn.data("item-type"),item_id:btn.data("item-id"),add:btn.hasClass("save-observer-add")?1:0},success:function(data){if(data["code"]==1){btn.toggleClass("save-observer-add");btn.toggleClass("button-default-empty button-default");btn.find("i").toggleClass("fa-plus fa-check");var text=btn.find("span").text();btn.find("span").text(text==vblang("global.follow")?vblang("global.following"):vblang("global.follow"));btn.blur()}else{showInfoDialog(vblang("error.common"),vblang("dialog.error"))}},error:function(){showInfoDialog(vblang("error.common"),vblang("dialog.error"))},complete:function(){savingItemObserver=false}})}}})}function installProfileHeader(){if($(window).height()>550+60){installFixedElement($(".item-profile #scrolled-profile-header"),"fixedPos",true,null);if($(".item-profile .profile_buttons a").length>0){$("#scrolled-profile-btn").click(function(){if($(this).find(".dd-menu").length>0){if($(this).find(".dd-menu").is(":visible")){$(this).find(".dd-menu").slideUp("fast")}else{$(this).find(".dd-menu").slideDown("fast")}}else{var ddMenuHtml='<ul class="dd-menu standard_tooltip_box" style="display: none; right: 10px; top: 45px;">';$(".item-profile .profile_buttons a").each(function(){ddMenuHtml+="<li>"+$("<div />").append($(this).clone().removeAttr("class")).html()+"</li>"});ddMenuHtml+="</ul>";$(this).append(ddMenuHtml);$(this).find(".dd-menu").slideDown("fast")}})}else{$("#scrolled-profile-btn").hide()}}}function installShowingBigProfilImages(){$(".image_container img").click(function(){if($(this).attr("big-src")){showImage($(this).attr("big-src"))}else{showImage($(this).attr("src"))}});$(".image-container-img-link").click(function(e){e.preventDefault();showImage($(this).attr("href"))});var selector=".fanclub_stats_container:not(.added-wallpaper) .fanclub_stats";if(isMobile!="true"){selector=selector+", .fanclub_stats_container:not(.added-wallpaper) .fanclub_stats__max-width"}$(selector).click(function(e){if($(e.target).hasClass("fanclub_stats__max-width")&&isMobile!="true"||$(e.target).hasClass("fanclub_stats")){var fanclubStats$=$(this).closest(".fanclub_stats_container").find(".fanclub_stats");if(fanclubStats$.data("big-background-src")){showImage(fanclubStats$.data("big-background-src"))}else if(fanclubStats$.data("background-src")){showImage(fanclubStats$.data("background-src"))}}})}function addFixedElement(element,elementTop,headerHeight,cssClass,showHide){if($(window).scrollTop()>=elementTop-headerHeight){element.addClass(cssClass);if(showHide){element.removeClass("v-hidden")}}else{element.removeClass(cssClass);if(showHide){element.addClass("v-hidden")}}}function installEditItemInfo(){$(".edit-social-admin-btn").click(function(){window.location.href=$(".edit-profile-admin-btn").attr("href")});$(document).on("click",".edit-profile-btn, .edit-social-btn, #editTournamentInfo",function(){var item_profile=$(".item-profile");var edit_item_dialog=$("#edit_item_dialog");var type=item_profile.data("type");var url=null;openDialog(edit_item_dialog);if(type=="A"){url="get_edit_arena_data_view"}else if(type=="P"){url="get_edit_player_data_view"}else if(type=="T"){url="get_edit_team_data_view"}else if(type=="O"){url="get_edit_tournament_data_view"}else if(type=="S"){url="get_edit_tournament_type_data_view"}edit_item_dialog.load(basedir+"ajax/"+url,{item_id:item_profile.data("id"),edit_social:$(this).hasClass("edit-social-btn")?"1":"0"},function(){centerDialog(edit_item_dialog)})})}function installGlobalTooltips(){if(isMobile!="true"){$(window).load(function(){if($('[title]:not([title=""]):not(.no-tooltip)').length>0){Tipped.create('[title]:not([title=""]):not(.no-tooltip)',{maxWidth:200})}tooltip_item()});$(document).ajaxSuccess(function(){if($('.tooltip-ajax-reloaded,[title]:not([title=""]):not(.no-tooltip)').length>0){Tipped.create('.tooltip-ajax-reloaded,[title]:not([title=""]):not(.no-tooltip)',{maxWidth:200})}tooltip_item()})}}function installTerm(){if($("body").data("terms")=="0"){addUniversalDialog("google_regulations_dialog",vblang("dialog.terms"),false,null);createUniversalDialogLoadContent("google_regulations_dialog",{},"get_terms");var google_regulations_dialog=$("#google_regulations_dialog");google_regulations_dialog.closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove();google_regulations_dialog.dialog("option","beforeClose",function(){return false});google_regulations_dialog.dialog("option","buttons",[{text:"I don't accept it",click:function(){addLoadingToButton($("#google_regulations_dialog_cancel"),true);window.location=$("#terms_of_use_dialog_header").data("logout-url")},class:"button-standard button-transparent button-light-gray",id:"google_regulations_dialog_cancel"},{text:"I accept terms",click:function(){acceptTerms()},class:"button-standard button-default",id:"google_regulations_dialog_accept"}])}}function acceptTerms(){addLoadingToButton($("#google_regulations_dialog_accept"),true);$.ajax({url:basedir+"ajax/accept_terms",data:{},type:"POST",dataType:"xml",success:function(data){var response=$("response code",data).text();if(response=="1"){addLoadingToButton($("#google_regulations_dialog_accept"),false);$("#google_regulations_dialog").closest(".ui-dialog").remove();$(".ui-widget-overlay").remove();$("body").removeClass("stop-scrolling")}}})}function installLoggingAdClick(){$(document).on("click",".own-picture",function(){ga("send","event","Own Advertise Link",window.location.href,$(this).attr("alt"))})}function installCloseDialogButton(){$(document).on("click",".button-close-dialog",function(){btnClickCloseDialog($(this))})}function updateHorizontalScrollUI(outer){var maxWidth=outer.outerWidth(true);var actualWidth=0;$.each(outer.find(".horizontal-s-inner").children(),function(i,item){actualWidth+=$(item).outerWidth(true)});if(actualWidth<=maxWidth){outer.siblings(".horizontal-s-right-btn").css("visibility","hidden")}}function installAllHorizontallScrolls(){var horizontal_scroll=$(".horizontal-s");if(horizontal_scroll.length>0){horizontal_scroll.each(function(){installHorizontallScroll($(this))});$(".horizontal-s-left-btn").click(function(){var btn=$(this);var outerElement=btn.siblings(".horizontal-s-outer");var leftPos=outerElement.scrollLeft();if(outerElement.scrollLeft()>0){btn.siblings(".horizontal-s-right-btn").css("visibility","visible")}outerElement.animate({scrollLeft:leftPos-350},400,function(){if(outerElement.scrollLeft()<=0){btn.css("visibility","hidden")}})});$(".horizontal-s-right-btn").click(function(){var btn=$(this);var outerElement=btn.siblings(".horizontal-s-outer");btn.siblings(".horizontal-s-left-btn").css("visibility","visible");var leftPos=outerElement.scrollLeft();outerElement.animate({scrollLeft:leftPos+350},400,function(){if(outerElement.get(0).scrollWidth<=outerElement.outerWidth()+outerElement.scrollLeft()){btn.css("visibility","hidden")}})})}}function installHorizontallScroll(elem){var items=elem.children();elem.prepend('<div class="horizontal-s-left-btn" style="visibility: hidden;"><</div>');elem.append('<div class="horizontal-s-right-btn">></div>');items.wrapAll('<div class="horizontal-s-inner" />');elem.find(".horizontal-s-inner").wrap('<div class="horizontal-s-outer"/>');var outer=elem.find(".horizontal-s-outer");outer.animate({scrollLeft:0},1);updateHorizontalScrollUI(outer);$(window).resize(function(){updateHorizontalScrollUI(outer)})}function installFixedElement(element,cssClass,showHide,minWidth){if(element.length>0){if(!inIframe()){var advertiseTop=element.offset().top;var headerHeight=60;var window$=$(window);if(minWidth==null||window$.width()>minWidth){addFixedElement(element,advertiseTop,headerHeight,cssClass,showHide)}window$.scroll(function(){if(minWidth==null||window$.width()>minWidth){addFixedElement(element,advertiseTop,headerHeight,cssClass,showHide)}})}}}function inIframe(){try{return window.self!==window.top}catch(e){return true}}function btnClickCloseDialog(btn){btn.closest(".ui-dialog-content").dialog("close")}function installBrowserFocus(){var window$=$(window);window$.focus(function(){tabActiveGlobal=true});window$.blur(function(){tabActiveGlobal=false})}function installTooltips(triggerSelector){if(isMobile!="true"){if(!triggerSelector){triggerSelector=".tooltip-trigger"}if($(triggerSelector).length>0){Tipped.create(triggerSelector,function(element){return{content:$(element).closest(".tooltip-container").find(".tooltip-info").html()}},{maxWidth:200})}}}function lockAjaxLoadingForMatchesTab(){if($(".ajax-tabs.tabs-profile").length>0&&$(".ajax-scrolled").length>0){var choosed_tab=$(".ajax-tabs").data("choosed");$(".ajax-scrolled").data("lockajaxloading",choosed_tab=="matches"||choosed_tab=="indoor_matches"||choosed_tab=="beach_matches")}}function tabsSetup(){var tabsSubmenu$=$(".tabs_submenu");if(tabsSubmenu$.length>0){tabsSubmenu$.appendTo(document.body)}lockAjaxLoadingForMatchesTab();$(document).on("click",".ajax-tabs li p a, .tabs_submenu li a",function(e){e.preventDefault();if($(this).closest(".ajax-tabs").data("disabled")){return false}$(".ajax-tabs").data("choosed",$(this).attr("id"));var isMainCategory=$('.tabs_submenu[data-parent-category="'+$(this).attr("id")+'"]').length<1;if($(this).parent("p").parent("li").hasClass("active")&&isMainCategory){return false}var parentCategory=$(this).closest("ul").data("parent-category");var loadedSubcategory=false;var url=$(this).closest(".ajax-tabs").data("ajax-url");var form=$(this).closest(".ajax-tabs").find(".tabs-parameters");tabsSubmenu$.hide();if(parentCategory){tabsSubmenu$.find(".checked").removeClass("checked");var parentCategory$=$("#"+parentCategory);parentCategory$.closest("li").addClass("active");$(this).addClass("checked");url=parentCategory$.closest(".ajax-tabs").data("ajax-url");form=parentCategory$.closest(".ajax-tabs").find(".tabs-parameters")}else{if(!isMainCategory){var subcategory$=$('.tabs_submenu[data-parent-category="'+$(this).attr("id")+'"]');subcategory$.css("left",$(this).offset().left);if($(this).closest("li").length>0){subcategory$.css("top",$(this).closest("li").offset().top+$(this).closest("li").outerHeight())}subcategory$.show();loadedSubcategory=true;$(".ajax-tabs li.active").removeClass("active");$(this).closest("li").addClass("active")}}if(!loadedSubcategory){var data={};addParametersToObject(form,data);data["tabName"]=$(this).attr("id");if(form.find('input[name="page"]').length>0){form.find('input[name="page"]').val("")}getItemTab($(this),data,url);lockAjaxLoadingForMatchesTab()}})}function addParametersToObject(form,data){if(form.length>0){var formFields=form.find("input,select:not(.gender-switcher)");for(var i=0;i<formFields.length;++i){var element=formFields[i];if(element.name&&(!$(element).is(":checkbox")||$(element).is(":checked"))){data[element.name]=element.value}}}}function getTypeName(typeSymbol){var type=null;if(typeSymbol=="U"){type=vblang("type.users")}else if(typeSymbol=="T"){type=vblang("type.teams")}else if(typeSymbol=="A"){type=vblang("type.arenas")}else if(typeSymbol=="P"){type=vblang("type.players")}else if(typeSymbol=="S"){type=vblang("type.staff")}else if(typeSymbol=="Y"){type=vblang("type.agencies")}else if(typeSymbol=="O"){type=vblang("type.tournaments")}else if(typeSymbol=="G"){type=vblang("type.tags")}return type}function addAutocompleteTriggers(){$(".autocomplete-item-suggestions .autocomplete-input").each(function(){var autocompleter=$(this);if(autocompleter.hasClass("ui-autocomplete-input")){autocompleter.autocomplete("destroy");autocompleter.removeData("autocomplete");autocompleter.off("click")}var searchedItems=autocompleter.data("searched-items");var searchOneType=searchedItems.indexOf(",")<0;var currentType="";var currentItemNumber=0;var limitSubitems=6;var data={searchedItems:searchedItems,limitSubitems:limitSubitems};var form=autocompleter.siblings("div.autocomplete-parameters");addParametersToObject(form,data);autocompleter.autocomplete({source:function(request,response){form=autocompleter.siblings("div.autocomplete-parameters");addParametersToObject(form,data);data["query"]=request.term;$.ajax({url:basedir+"ajax/"+autocompleter.data("url"),data:data,type:"POST",dataType:"json",success:function(data){if(searchedItems=="matches"){response($.map(data,function(item){return{label:item.name,host_image:item.host_image,guest_image:item.guest_image,host_name:item.host_name,guest_name:item.guest_name,host_sets:item.host_sets,guest_sets:item.guest_sets,image:item.image,desc:item.desc,link:item.link,value:item.id,type:item.type}}))}else{response($.map(data,function(item){return{label:item.name,image:item.image,desc:item.desc,link:item.link,value:item.id,type:item.type,subtype:item.subtype}}))}},error:function(){autocompleter.removeClass("ui-autocomplete-loading")}})},minLength:autocompleter.data("minlength"),appendTo:autocompleter.closest(".autocomplete-item-suggestions"),create:function(){$(this).data("ui-autocomplete")._renderItem=function(ul,item){if(searchedItems=="matches"&&item.value!=-1){var element=$("<li>").append('<a><span class="fontSize12px desc dBlock div-1-1 tac">'+item.desc+"</span>"+'<span class="match-autocomplete-box match_box dBlock div-1-1">'+'  <span class="match-autocomplete-team match-autocomplete-home-team team tar left">'+item.host_name+' <img src="'+item.host_image+'" class="small_image right" /></span>'+'  <span style="" class="dBlock match-autocomplete-score score tac left">'+item.host_sets+" : "+item.guest_sets+"</span>"+'  <span class="match-autocomplete-team match-autocomplete-guest-team team left"><img src="'+item.guest_image+'" class="small_image" /> '+item.guest_name+"</span>"+"</span>"+'<div class="clear"></div></a>').after("<li></li>");return element.appendTo(ul)}else if(item.value=="-2"){var element=$("<li>").append('<span class="fontSize12px desc dBlock div-1-1 padding10">'+vblang("global.no_data")+"</span>");return element.appendTo(ul)}else if(item.value=="-3"){var otherServiceLink=$("<a/>").addClass("dBlock").addClass("padding10").addClass("fontSize11pt");var otherServiceMenLink=otherServiceLink.clone().attr("href",basedirMen+"search?q="+encodeURI(autocompleter.val())).text(vblang("search.men"));var otherServiceWomenLink=otherServiceLink.clone().attr("href",basedirWomen+"search?q="+encodeURI(autocompleter.val())).text(vblang("search.women"));var otherServiceBeachLink=otherServiceLink.clone().attr("href",basedirBeach+"search?q="+encodeURI(autocompleter.val())).text(vblang("search.beach"));if(groundGlobal=="I"&&genderGlobal=="M"){otherServiceWomenLink.appendTo(ul);otherServiceBeachLink.appendTo(ul)}else if(groundGlobal=="I"&&genderGlobal=="W"){otherServiceMenLink.appendTo(ul);otherServiceBeachLink.appendTo(ul)}else if(groundGlobal=="B"){otherServiceMenLink.appendTo(ul);otherServiceWomenLink.appendTo(ul)}return $("<li>")}else{if(!searchOneType&&item.type!=currentType&&item.value!="-1"){$("<li/>").addClass("ui-autocomplete-category").text(getTypeName(item.type)).appendTo(ul);currentItemNumber=0}currentType=item.type;var element=$("<li>").append("<a>"+(item.image?'<img class="'+(item.type=="P"||item.type=="U"||item.type=="S"?"rounded-image":"")+'" src="'+item.image+'" alt="img" />':"")+'<span class="ellipsis-text">'+item.label+"</span>"+(item.desc?'<span class="desc ellipsis-text">'+item.desc+"</span>":"")+"</a>").append('<div class="clear"></div>').after("<li></li>");var result=element.appendTo(ul);if(!searchOneType&&data["mainSearchRequest"]){currentItemNumber++;if(currentItemNumber==limitSubitems){$("<a/>").addClass("dBlock").addClass("padding10").addClass("fontSize11pt").attr("href",basedir+"search?q="+encodeURI(autocompleter.val())+"#"+getTypeName(item.type).toLowerCase().replace(/\s+/g,"-")).text(vblang("global.more")).appendTo(ul)}}return result}}},select:function(event,ui){if($(event.target).closest("li").hasClass("autocomplete-item-link")){$(event.target).find("a").click()}else{event.preventDefault();if(ui.item&&ui.item.value=="-1"){$(this).trigger("addNewItemEvent")}else if(ui.item&&(ui.item.value=="-2"||ui.item.value=="-3")){}else{$(this).val(ui.item?ui.item.label:"");$(this).siblings('input[type="hidden"]').val(ui.item?ui.item.value:"");$(this).trigger("selectedItemEvent",[ui.item?ui.item.link:"",ui.item?ui.item.subtype:""])}}},focus:function(event){event.preventDefault()},open:function(){$(this).addClass("autocomplete-opened");$(this).autocomplete("widget").css({width:$(this).outerWidth()+"px"});expandBodyOnOpenCloseAutocomplete($(this).autocomplete("widget"),true)},close:function(){$(this).removeClass("autocomplete-opened");expandBodyOnOpenCloseAutocomplete($(this).autocomplete("widget"),false)},search:""}).click(function(){autocompleter.autocomplete("search")});autocompleter.on("autocompletesearch",function(){currentType="";currentItemNumber=0})})}function initValidationRules(){$.validator.addMethod("validChars",function(value,element){return this.optional(element)||!/[!$%^&*()_+|~=`\\#{}\[\]:";<>?,\/]/.test(value)},vblang("error.letters"));$.validator.addMethod("ext",function(value,element){return this.optional(element)||correctExtenstion(value)},vblang("error.file_types"));$.validator.addMethod("validDate",function(value,element){return this.optional(element)||/^\d{4}[-](0[1-9]|1[012])[-](0[1-9]|[12][0-9]|3[01])$/.test(value)},vblang("error.date"));$.validator.addMethod("not0",function(value,element){return this.optional(element)||value!=0},vblang("error.option"));$.validator.addMethod("greaterThan",function(value,element,params){var date=new Date(value);if($(params).val()&&!/Invalid|NaN/.test(date.toString())){return new Date(value)>=new Date($(params).val())}return this.optional(element)||isNaN(value)&&isNaN($(params).val())||Number(value)>Number($(params).val())||!$(params).val()});$.validator.addMethod("exactlength",function(value,element,param){return this.optional(element)||value.length==param},$.format("Please enter exactly {0} characters"));$.validator.addMethod("invalidURL",function(value,element){return this.optional(element)||validateURL(value)},vblang("error.link.invalid"));$.validator.addMethod("invalidExternalURL",function(value,element){return this.optional(element)||urlHasParamOrPath(value)&&!urlTransfersIsAmongBlocked(value)},vblang("error.link.invalid"));$.validator.addMethod("validTime",function(value,element){return this.optional(element)||/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(value)},vblang("error.time_format"));$.validator.addMethod("validLogin",function(value,element){return this.optional(element)||/^[A-Za-z0-9_-]+$/.test(value)},vblang("error.login_chars"));$.validator.addMethod("isLoginUsed",function(value,element){return this.optional(element)||!isUserdataUsed(value,"nick",0)},vblang("error.taken_login"));$.validator.addMethod("isEmailUsed",function(value,element){return this.optional(element)||!isUserdataUsed(value,"mail",1)},vblang("error.taken_email"));$.validator.addMethod("decimal",function(value,element){return this.optional(element)||/^[0-9]+(\.\d{0,2})?$/.test(value)},vblang("error.invalid_rank"));$.validator.addMethod("notEmpty",function(value,element){return this.optional(element)||value!=null&&value!=""&&value!="[]"},vblang("error.no_item"));$.validator.addMethod("categoryExists",function(value,element){return this.optional(element)||ifMovieCategoryExists(value)},vblang("error.category"));$.validator.addMethod("tournamentExists",function(value,element,arg){return this.optional(element)||!ifTournamentExists(element,value,arg)},vblang("error.tournament_exists"));$.validator.addMethod("latinAlphabet",function(value,element){return this.optional(element)||!containsInvalidCharacters(value)},vblang("error.latin_alphabet"))}function containsInvalidCharacters(text){const cyrillicRegex=/[\u0400-\u04FF]/;const greekRegex=/[\u0370-\u03FF]/;const chineseRegex=/[\u4E00-\u9FFF]/;const japaneseRegex=/[\u3040-\u30FF\u31F0-\u31FF\uFF00-\uFFEF]/;if(cyrillicRegex.test(text)||greekRegex.test(text)||chineseRegex.test(text)||japaneseRegex.test(text)){return true}else{return false}}function showLoginDialog(title,text,ajax){addUniversalDialog("login-dialog",title,true,null);createUniversalDialogLoadContent("login-dialog",{text:text,ajax:ajax?1:0,url:inIframe()?basedir+"pwa":$("body").data("url")},"get_login_view")}function installMenuLoginWindow(){$(".top_menu_me").click(function(){$("#user_menu").show()});$("#top_main_login").click(function(){showLoginDialog(vblang("dialog.login"),null,false)});$(document).click(function(event){var target=event.target;var target$=$(target);var users_actions_window$=$("div.users_actions_window");var user_inbox_window$=$("div.user_inbox_window");var user_menu$=$("#user_menu");if(users_actions_window$.css("display")!=="none"&&!target$.hasClass("users_actions_window")&&target$.closest("div.users_actions_window").length===0&&!target$.parent("a").hasClass("top_menu_user")&&target.id!=="actions_amount"){users_actions_window$.hide()}if(user_inbox_window$.css("display")!=="none"&&!target$.hasClass("user_inbox_window")&&target$.closest("div.user_inbox_window").length===0&&!target$.parent("a").hasClass("top_menu_msg")&&target.id!=="msg_amount"){user_inbox_window$.hide()}if(user_menu$.css("display")!=="none"&&!target$.hasClass("top_menu_me")&&target$.closest("div.top_menu_me").length===0&&target.id!=="user_menu"){user_menu$.hide()}if($(".other-subdomains:visible").length>0&&!target$.hasClass("text_header")&&!target$.closest("div").hasClass("text_header")&&!target$.closest("div").hasClass("global_mode_container")&&!target$.hasClass("other-subdomains")&&!target$.closest("div").hasClass("other-subdomains")){hideOtherSubdomains()}if($(".ui-widget-overlay-search").length>0&&target.id!=="searchItem"&&!target$.closest("ul").hasClass("ui-autocomplete")&&!target$.hasClass("search_ajax_autocomplete")){escapeSearchItem()}})}function escapeSearchItem(){var overlay$=$(".ui-widget-overlay-search");overlay$.fadeOut();overlay$.remove();if($("body").hasClass("dark-skin")){$(".search_ajax_autocomplete input").css("color","#fff").css("background-color","#3a3b3c")}}function frameTriggerEvents(){var iframe=window.frameElement;if(iframe){iframe.contentDocument=document;var parent=window.parent;$(parent.document).ready(function(){var parent$=parent.jQuery;if(parent$){parent$(iframe).trigger("iframeloading");$(function(){parent$(iframe).trigger("iframeready")});$(window).load(function(){parent$(iframe).trigger("iframeloaded")});$(window).unload(function(){parent$(iframe).trigger("iframeunloaded")});$(window).on("beforeunload",function(){parent$(iframe).trigger("iframebeforeunload")})}})}if(inIframe()){var params=new URL(location.href).searchParams;if(params){var refresh=params.get("refresh");if(refresh=="pwa"){top.location=basedir+"pwa"}}}}function installMenuCategories(){$(".top_main_category[data-subcategory=true] a").click(function(){if($(window).width()<1180){var category=$(this).closest(".top_main_category");var subcategory=$('ul.menu_subitem[data-category="'+category.data("name")+'"]');var isVisible=subcategory.is(":visible");subcategory.slideToggle(200,function(){if(!isVisible){subcategory.removeAttr("style")}})}});$(".top_main_category[data-subcategory=true]").hover(function(){if($(window).width()>=1180){var category=$(this);var subcategory=$('ul.menu_subitem[data-category="'+category.data("name")+'"]');subcategory.fadeIn("fast").animate({top:"47px"},{duration:"fast",queue:false},function(){})}},function(){if($(window).width()>=1180){var category=$(this);var subcategory=$('ul.menu_subitem[data-category="'+category.data("name")+'"]');subcategory.fadeOut("fast").animate({top:"60px"},{duration:"fast",queue:false},function(){})}});$(window).on("resize",function(){if($(window).width()>=1180){var categories$=$(".menu-categories");if(!categories$.is(":visible")){categories$.show()}if(menuVisible){hideLeftMenu()}}});$(".mobileMenuImg").click(function(){if(!menuVisible){$(this).addClass("is-active");if(isMobile!="true"){var categories$=$(".menu-categories");categories$.show();categories$.animate({left:"0px"},{duration:400,queue:false});categories$.css("overflow-y","scroll")}else{var mobileLeftMenu$=$("#mobileLeftMenu");mobileLeftMenu$.show();mobileLeftMenu$.animate({left:"0px"},{duration:400,queue:false});mobileLeftMenu$.css("overflow-y","scroll")}var body$=$("body");if($(".ui-widget-overlay-mobile-menu").length<1){body$.prepend('<div class="ui-widget-overlay ui-front ui-widget-overlay-mobile-menu" style="display: none;"></div>');$(".ui-widget-overlay-mobile-menu").fadeIn(2600)}body$.addClass("stop-scrolling");menuVisible=true}else{hideLeftMenu()}});installHidingLeftMenu();$('.top_main_category_link[role="button"], .top_main_category_link[role="button"] span').click(function(e){e.preventDefault();e.stopPropagation()})}function installOtherSubdomains(){var textHeader$=$(".section-top-inner .text_header");textHeader$.click(function(){if(textHeader$.data("clicked")){hideOtherSubdomains()}else{var otherSubdomains$=$(".other-subdomains");otherSubdomains$.css("left",$(".section-top-inner").offset().left);otherSubdomains$.show();$(".text_header_other_icon").addClass("open-icon");otherSubdomains$.animate({top:"60"},300,"swing",function(){textHeader$.data("clicked",true)})}});$(".other-subdomains a").click(function(){$(".other-subdomains a.website-active").removeClass("website-active");$(this).addClass("website-active")})}function hideOtherSubdomains(){$(".text_header_other_icon").removeClass("open-icon");$(".other-subdomains").animate({top:"-165"},300,"swing",function(){$(".section-top-inner .text_header").data("clicked",false);$(".other-subdomains").hide()})}function showInfoErrorDialogs(){var header$=$("header");var info=header$.data("info");var error=header$.data("error");if(info){showInfoDialog(info)}else if(error){showInfoDialog(error,vblang("dialog.error"))}}function globalLockUnlockSubmit(lock,button){if(!button){button=$("#submit_button_hall")}addLoadingToButton(button,lock);globalAddingConnection=lock}function setCookie(c_name,value,exdays){var exdate=new Date;exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+(exdays==null?"":"; expires="+exdate.toUTCString());document.cookie=c_name+"="+c_value+";domain=.volleybox.net;path=/"}function getCookie(name){var value="; "+document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)return parts.pop().split(";").shift()}function mtable_voting(item_id){$(".rating_container .big_vote").click(function(){const big_vote=$(this);if(big_vote.hasClass("active")){return false}const rating_container$=big_vote.parent(".rating_container");if(rating_container$.data("clicked")){return}rating_container$.data("clicked",true);const item_type=rating_container$.data("type");const rating_box=rating_container$.find(".rating_box");const vote=big_vote.hasClass("up")?"5":"1";let url="";if(item_id==null){item_id=rating_container$.closest(".movie_box").data("movie-id");if(!item_id){item_id=rating_container$.closest(".movie_box").data("id")}}if(item_type=="movie_page"){url=basedir+"ajax/movie_vote"}else if(item_type=="topic_page"){url=basedir+"ajax/topic_vote"}else if(item_type=="link_page"){url=basedir+"ajax/link_vote"}else if(item_type=="post"){url=basedir+"ajax/chat_post_vote"}$.post(url,{item_id:item_id,vote:vote},function(data){item_id=null;rating_container$.data("clicked",false);var response=$("response code",data).text();if(response=="-1"){showUnloggedInfo(vblang("logged.vote"))}else if(response=="-2"){showInfoDialog("You disliked <b>"+dislikesLockAmount+"</b> items in short period.<br/>"+"Wait some time and you will be able to dislike this item again.",vblang("dialog.error"))}else if(response=="-3"){showInfoDialog("You already voted for this "+item_type.replace("_page","")+" from other account",vblang("dialog.error"))}else if(response=="1"){rating_box.text($("response new_rating",data).text());if(rating_container$.hasClass("rating_container_buttons")){var current_vote=parseInt(big_vote.find("var").text(),10);var current_active=rating_container$.find(".big_vote.active");if(current_active){var current_active_vote=parseInt(current_active.find("var").text(),10);current_active.find("var").text(current_active_vote-1)}big_vote.find("var").text(current_vote+1)}rating_container$.addClass("active");rating_container$.find(".big_vote.active").removeClass("active");big_vote.addClass("active")}})})}function scroll_to_element(element,duration){if(element&&element.length>0){var offset=element.offset();if(!duration){duration=1e3}$("html,body").animate({scrollTop:offset.top-$("header").outerHeight()},{duration:duration,complete:function(){loadingGifOnElement(element,false)}})}}function rateComment(clicked_element,vote,type,comment_id){if(type==null){type=clicked_element.closest(".comment_box").data("type")}if(userId=="0"){showUnloggedInfo(vblang("logged.vote_comment"));return}if(clicked_element.closest(".plus_minus").hasClass("disabled")){return}clicked_element.closest(".plus_minus").addClass("disabled");if(comment_id==null){comment_id=clicked_element.closest(".comment_box").data("id")}var methodName=null;var fieldName=null;var upvoted=vote==1;if(type=="movie"){methodName="comment_vote";fieldName="comment_id"}else if(type=="topic"||type=="forum_topic"){methodName="post_vote";fieldName="post_id"}else if(type=="topic_page"){methodName="topic_vote";fieldName="item_id";upvoted=vote==5}else if(type=="transfer"){methodName="vote_comment_transfer";fieldName="post_id"}else if(type=="link"){methodName="link_comment_vote";fieldName="comment_id"}else if(type=="chat"){methodName="chat_comment_vote";fieldName="comment_id"}else if(type=="team_review"){methodName="team_review_vote";fieldName="review_id"}else if(type=="agency_review"){methodName="agency_review_vote";fieldName="review_id"}else if(type=="related"){methodName="related_vote";fieldName="related_id"}$.post(basedir+"ajax/"+methodName,fieldName+"="+comment_id+"&vote="+vote,function(data){var response=$("response code",data).text();if(response=="-3"){showInfoDialog(vblang("error.voted_comment"),vblang("dialog.error"))}else if(response=="1"){var span=clicked_element.closest(".comment_plus_minus_container").find(".comment_rating");var rating=parseInt(span.text());if(upvoted){rating+=1}else{rating-=1}if(rating>0){rating="+"+rating;span.addClass("comment_rating_pos")}else if(rating<0){span.addClass("comment_rating_neg")}else if(rating==0){span.removeClass("comment_rating_pos");span.removeClass("comment_rating_neg")}span.text(rating)}})}function installComments(){$(document).on("mouseenter",".comment_box",function(){if($(this).find(".edition-options").length<1){$(this).find(".toggled-comment-options").show()}});$(document).on("mouseleave",".comment_box",function(){$(this).find(".toggled-comment-options").hide()});$(document).on("click",".comment_box .plus",function(){rateComment($(this),1,null,null)});$(document).on("click",".comment_box .minus",function(){rateComment($(this),0,null,null)});$(document).on("click",".comment_edit .delete",function(){deleteComment($(this))});$(document).on("click",".comment_edit .report",function(){showReportCommentBox($(this))});$(document).on("click",".comment_edit .edit",function(){var button$=$(this);script(basedirWithoutLang+"media/js/customized-ckeditor_v9.min.js?1.2",function(){editComment(button$)})});$(document).on("click","#type_comment",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.add_comment"));$(this).blur()}});initializeMediaObjects()}function initializeMediaObjects(){loadEmbeds()}function msg_actions_cnt_setup(){update_msg_cnt();update_actions_cnt();setInterval(function(){update_msg_cnt()},8e3);setInterval(function(){update_actions_cnt()},8e3)}function online_setup(isLogged){if(isLogged){setInterval(function(){update_online()},8e3)}update_online()}function update_msg_cnt(){if(userId>0){var currentAmount=parseInt($("#msg_amount").text());$.post(basedir+"ajax/get_msg_count/"+userId,function(data){if(userId>0){if(data=="-1"){var buttons='<a role="button" tabindex="0" id="logged-out-info-close" class="marginRight5 button-transparent button-close-dialog">'+"  <span>"+vblang("global.close")+"</span>"+"</a>"+'<a role="button" tabindex="0" id="logged-out-info-login" class="marginLeft5 button-standard button-default">'+'  <i class="fal fa-user-circle fa-lg"></i>'+"  <span>"+vblang("login_label")+"</span>"+"</a>";showInfo("logged-out-info-dialog",vblang("dialog.logged_out"),vblang("dialog.logged_out.desc"),null,buttons);$(document).on("click","#logged-out-info-login",function(){showLoginDialog(vblang("dialog.login"),null,true)});ga("send","event","You have been logged out of the system",window.location.href,"Logged out");userId=0}else if(data!=currentAmount){var msgAmount$=$("#msg_amount");if(data>0&&currentAmount==0){msgAmount$.show()}if(currentAmount>0&&data==0){msgAmount$.hide()}msgAmount$.text(get_limited_number(data));update_meta_title()}}})}}function update_actions_cnt(){if(userId>0){var actionsAmount$=$("#actions_amount");var currentAmount=parseInt(actionsAmount$.text());$.post(basedir+"ajax/get_actions_count/"+userId,function(data){if(data!=currentAmount){if(data>0&&currentAmount==0){actionsAmount$.show();actionsAmount$.closest(".top_menu_user").find("i").addClass("bell-vibrate-animation")}if(currentAmount>0&&data==0){actionsAmount$.hide();actionsAmount$.closest(".top_menu_user").find("i").removeClass("bell-vibrate-animation")}actionsAmount$.text(get_limited_number(data));update_meta_title()}})}}function get_limited_number(number){var returned_value="";if(number!=null&&number!=""){if(isNaN(number)){returned_value=""}else{number=parseInt(number,10);if(number>=100){returned_value="99+"}else{returned_value=number}}}else{returned_value=number}return returned_value}function update_meta_title(){var actions_count$=$("#actions_amount");var actions_count=actions_count$.length>0?actions_count$.text():0;var msg_count$=$("#msg_amount");var msg_count=msg_count$.length>0?msg_count$.text():0;actions_count=actions_count?parseInt(actions_count,10):0;msg_count=msg_count?parseInt(msg_count,10):0;var total=actions_count+msg_count;if(total>0){document.title="("+total+") "+$('meta[property="og:title"]').attr("content")}else{document.title=$('meta[property="og:title"]').attr("content")}}function formatZero(src){if(src<10)return"0"+src;else return src}function serverDate2Local(serverString,hideTime,hideDate){if(!serverString){return""}var d=serverDate2LocalDate(serverString);return(hideDate?"":d.getFullYear()+"-"+formatZero(d.getMonth()+1)+"-"+formatZero(d.getDate()))+(!hideDate&&!hideTime?" ":"")+(hideTime?"":formatZero(d.getHours())+":"+formatZero(d.getMinutes()))}function serverDate2LocalDate(serverString){if(serverString==""){return""}return new Date(serverString*1e3)}function installMatchBox(match_box,if_games){var date=match_box.find(".date");var convertedDate=serverDate2Local(date.text(),false,match_box.hasClass("match-box-mvp"));if(convertedDate.indexOf("NaN")!==-1){return false}if(if_games){var convertedDateTime=serverDate2LocalDate(date.text());if(convertedDateTime-new Date>0){match_box.find(".real_score").hide();match_box.find(".edit_score_div").show()}}if(convertedDate){match_box.data("hid_date",convertedDate.substr(0,10));match_box.data("hid_hour_time",convertedDate.substr(11,5));date.text(convertedDate.replace(" 00:00",""))}match_box.find(".date").removeClass("date")}function show_likers_item(id,type){if(id&&type){addUniversalDialog("item_likers",vblang("dialog.likers"),true,null);createUniversalDialogLoadContent("item_likers",{},"show_likers/"+id+"/"+type)}}var online_updating=false;function update_online(){if(!tabActiveGlobal||online_updating)return;online_updating=true;$.ajax({url:basedir+"ajax/online_count_refresh",data:{},type:"POST",dataType:"xml",async:true,success:function(data){online_updating=false;$("#logged_online").text(parseInt($("response logged",data).text(),10))},error:function(){online_updating=false}})}function showAjaxForm(btn){if(btn.hasClass("clicked")){$("#online-users-container").empty();btn.toggleClass("clicked")}else{var ps_online_users=null;$("#online-users-container").load(basedir+"ajax/get_online_users",{},function(){ps_online_users=new PerfectScrollbar("#online-users-container",{wheelPropagation:false,suppressScrollX:true});btn.toggleClass("clicked")})}}function isUserdataUsed(value,type,onlyVerified){var isUsed=false;if(value!=""){$.ajax({url:basedir+"ajax/is_data_used/"+value+"/"+type+"/"+onlyVerified,data:{},async:false,success:function(msg){isUsed=msg==="1"}})}return isUsed}function correctExtenstion(element){var ext=element.split(".").pop().toLowerCase();return!($.inArray(ext,["gif","png","jpg","jpeg","webp"])==-1)}function refreshTab(tab_id){var currentTab=null;if(tab_id){currentTab=$("#"+tab_id)}else{currentTab=$(".tabs .tabsLeft li.active a")}if(currentTab){currentTab.closest("li").removeClass("active");currentTab.trigger("click")}}function getItemTab(tab,data,url){if(!data["page"]){data["page"]=1}var containerSelector=".ajax-loaded-conent";if(tab.closest(".tabs").data("container-selector")){containerSelector=tab.closest(".tabs").data("container-selector")}var ajaxLoadedContainer=$(containerSelector);loadingGifOnElement(ajaxLoadedContainer,true);ajaxLoadedContainer.load(basedir+"ajax/"+url,data,function(response,status,xhr){loadingGifOnElement($(this),false);if(xhr.status!=200){return false}var currentItemsCount=tab.find("var");if(currentItemsCount&&currentItemsCount.length>0){if(response){var elements=$($.trim(response));var found=elements.filter('input[name="items_count"]');if(found){currentItemsCount.text(found.val())}elements=null}}tab.closest("ul").find("li.active").removeClass("active");tab.closest("li").addClass("active");ajaxLoadedContainer.trigger("data-loaded");if(tab.attr("href")&&!tab.closest(".tabs").hasClass("prevent-refresh-url")){refreshBrowserUrl(tab.attr("href")+(data["page"]>1?"/"+data["page"]:""))}})}function refreshAutocompleteValue(newlyAddedName,newlyAddedId){if(lastClickedAutocompleter){lastClickedAutocompleter.val(newlyAddedName);lastClickedAutocompleter.closest("div").children("input[type='hidden']").val(newlyAddedId)}}function refreshBrowserUrl(url){if(url!=null){var currentUrl=window.location.href;if(currentUrl!=null&&getDomainFromUrl(currentUrl)==getDomainFromUrl(url)){window.history.replaceState("object or string","Title",url);$("body").data("url",url)}}}function getDomainFromUrl(url){var arr=url.split("/");return arr[0]+"//"+arr[2]}function showAddForm(input,clearOnlyTextFields){var add_connection_cnt$=$(".add_connection_cnt");add_connection_cnt$.find(".item_autocompleter:not(.autocomplete-not-cleared)").val("");if(clearOnlyTextFields){add_connection_cnt$.find('input[type="text"]').val("")}else{add_connection_cnt$.find("input:not(.autocomplete-not-cleared)").val("")}add_connection_cnt$.find("select:not(.autocomplete-not-cleared)").val("").css("border-color","");add_connection_cnt$.find('input[type="text"]').css("border-color","");add_connection_cnt$.find("p.errors").remove();stdBtnChangeContent("add");$("div.ajax-edited-element").show();if($(".profile-header-container").length>0){add_connection_cnt$.insertAfter(input.closest(".profile-header-container"))}else{add_connection_cnt$.insertAfter(input.parent("div"))}add_connection_cnt$.show();var transferLink$=$("#transferLink");var edit_confirmation$=$("#edit_confirmation");if(transferLink$.length>0){transferLink$.hide()}if(edit_confirmation$.length>0){edit_confirmation$.hide()}}function addCloseTeamPlayerBtn(input){input.toggleClass("add-btn").toggleClass("cancel-btn");input.find("i").toggleClass("fa-plus").toggleClass("fa-times-circle")}function tooltip_item(){var tooltip_item$=$(".tooltip_item");if(tooltip_item$.length>0){var skin=$("body").hasClass("light-skin")?"light":"dark";tooltip_item$.each(function(){var elem=$(this);if(!elem.data("tooltip-initialized")&&!elem.hasClass("no-tooltip")){elem.data("tooltip-initialized",true);var id=elem.data("id");var user_nick=elem.data("user-nick");var item_type=elem.data("type");var season_id=elem.data("season-id");var tournament_id=elem.data("tournament-id");var position=elem.hasClass("guest")?"topleft":"topright";if(item_type=="U"&&id==3||item_type=="O"||item_type=="G"){return false}Tipped.create(this,{skin:skin,position:position,showDelay:500,maxWidth:350,ajax:{url:basedir+"ajax/get_tooltip_item",type:"post",data:{id:id,user_nick:user_nick,season_id:season_id,type:item_type,tournament_id:tournament_id}}})}})}}var ps_menu_actions=null;function showAjaxActions(){var users_actions_window$=$("div.users_actions_window");if(users_actions_window$.is(":visible")){users_actions_window$.hide()}else{users_actions_window$.show();$.post(basedir+"ajax/get_user_actions_list",{page:1},function(data){gLastScrollOffsetActions=1;users_actions_window$.find(".usr_actions_box .loading-container").remove();users_actions_window$.find(".usr_actions_box .action").remove();users_actions_window$.find(".usr_actions_box").append(data);users_actions_window$.find(".usr_actions_box").scrollTop(1);ps_menu_actions=new PerfectScrollbar("div.users_actions_window .usr_actions_box",{wheelPropagation:false,suppressScrollX:true})})}}var ps_menu_inbox=null;function showAjaxInbox(){var user_inbox_window$=$("div.user_inbox_window");if(user_inbox_window$.is(":visible")){user_inbox_window$.hide();$(".top_menu_msg").blur()}else{user_inbox_window$.show();$.post(basedir+"ajax/get_user_inbox_window",function(data){gLastScrollOffsetInbox=1;user_inbox_window$.find(".usr_inbox_box .loading-container").remove();user_inbox_window$.find(".usr_inbox_box .pm_ajax").remove();user_inbox_window$.find(".usr_inbox_box").append(data);user_inbox_window$.find(".usr_inbox_box").scrollTop(1);ps_menu_inbox=new PerfectScrollbar("div.user_inbox_window .usr_inbox_box",{wheelPropagation:false,suppressScrollX:true})})}}function showReportCommentBox(input){if(userId=="0"){showUnloggedInfo(vblang("logged.report_comment"))}else{const commentBox$=input.closest(".comment_box");var type=commentBox$.data("type");var id=commentBox$.data("id");var authorNick=commentBox$.data("author-nick");var reportType=null;if(type=="topic"||type=="forum_topic"){reportType=1}else if(type=="movie"){reportType=2}else if(type=="transfer"){reportType=3}else if(type=="link"){reportType=4}else if(type=="chat"){reportType=5}createUniversalDialogLoadContent("report_box",{comment_author_nick:authorNick,post_id:id,item_type:reportType},"get_violation_report_box")}}function openDialog(dialog){if(dialog!=null&&dialog.length>0&&dialog.hasClass("ui-dialog-content")){dialog.dialog("open")}}function centerDialog(dialog_element){if(dialog_element!=null&&dialog_element.length>0&&dialog_element.hasClass("ui-dialog-content")&&dialog_element.dialog("isOpen")){if(isMobile=="true"){dialog_element.dialog("option","position",{my:"center top",at:`center top+10`,of:window,collision:"fit"})}else{dialog_element.dialog("option","position","center")}}}function removeWhitespaces(input,czyTimeout){if(czyTimeout){setTimeout(function(){input.val($.trim(input.val()))},400)}else{input.val($.trim(input.val()))}}function removeWhitespacesAllFields(cssClass){$(cssClass).each(function(){if($(this).val()!="")removeWhitespaces($(this),false)})}function isScrolledIntoView($elem,offset){if($elem.length<1){return false}if(offset===undefined){offset=100}const $window=$(window);const docViewTop=$window.scrollTop();let docViewBottom=docViewTop+$window.height();if(offset){docViewBottom=docViewBottom+offset}const elemTop=$elem.offset().top;const elemBottom=elemTop+$elem.height();return elemTop<=docViewBottom&&elemTop>=docViewTop||elemBottom<=docViewBottom&&elemBottom>=docViewTop}function resetFormFields(input){var main_dropdowns_lists$=input.closest(".main_dropdowns_lists");main_dropdowns_lists$.find('input[type="text"]:not(.skip_reset)').val("");main_dropdowns_lists$.find('input[type="hidden"][name="country"]:not(.skip_reset)').val("");main_dropdowns_lists$.find("select:not(.skip_reset)").val("0");main_dropdowns_lists$.find("select[name=rank]:not(.skip_reset)").val("");main_dropdowns_lists$.find('input[type="checkbox"]:not(.skip_reset)').prop("checked",false);refreshItemsList(null,false,null,true)}function setPhotoAuthor(){$(".image_container, .image_container*").hover(function(){$(".photo_info_icon").show();$(".photo_delete_icon").show()},function(){$(".photo_info_icon").hide();$(".photo_delete_icon").hide()});if(isMobile=="true"){$(document).on("click","#image-overlay",function(){$(".photo_info_icon").show();$(".photo_delete_icon").show();$("#add_photo_trigger").show();showAddPhotoTrigger()})}}function validateURL(textval){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(textval)}function getMatchesDetails(link,tabName,wideView,ifGameView){var movie_details_container=link.closest(".match_box").find(".movie_details_container");var match_id=link.closest(".match_box").data("hid_match_id");var clickedMatchesTab=link.closest(".match_box").data("clicked_tab_match");if(clickedMatchesTab==""||clickedMatchesTab!=tabName){link.closest(".match_box").data("clicked_tab_match",tabName);movie_details_container.load(basedir+"ajax/get_match_"+tabName,{match_id:match_id,wide_view:wideView,game_view:ifGameView},function(){movie_details_container.show()})}else{movie_details_container.hide();link.closest(".match_box").data("clicked_tab_match","")}}function addMatchReportDialogBase(match_id,edit){if(userId=="0"){showUnloggedInfo(vblang("logged.match_report"))}else{addUniversalDialog("add_match_report_dialog",edit?vblang("dialog.edit_match_report"):vblang("dialog.add_match_report"),true,null,false);createUniversalDialogLoadContent("add_match_report_dialog",{match_id:match_id},"get_match_report_dialog")}}function saveMatchUser(link,wideView,ifGameView,future,add,matchId){if(userId=="0"){showUnloggedInfo(vblang("logged.match_participation"))}else{var info=null;if(add){if(future){info=vblang("match.live.will")}else{info=vblang("match.live.was")}}else{info=vblang("match.live.remove")}confirmFunction(info,function(){if(!matchId){matchId=link.closest(".match_box").data("hid_match_id")}$.ajax({type:"POST",url:basedir+"ajax/save_match_user",data:{match_id:matchId,add:add?1:0},success:function(data){var code=$("response code",data).text();if(code=="1"){if($("#match-fans-container").length>0){$("#match-fans-container").load(basedir+"ajax/get_match_participants",{match_id:matchId,wide_view:wideView,game_view:ifGameView})}else{link.closest(".match_box").data("clicked_tab_match","");getMatchesDetails(link,"participants",wideView,ifGameView)}}}})})}}function backHomepageMovie(){$("#movie_dialog").remove();var url=$('meta[property="og:url"]').attr("content");refreshBrowserUrl(url);$("body").removeClass("stop-scrolling")}function showHomepageMovie(e,id,url){if($(".homepage-site").length>0||navigator.userAgent.indexOf("iPad")>0||navigator.userAgent.indexOf("iPhone")>0){return true}if(url===undefined){url=$(e.target).attr("href")}if($(".movie-page").length>0){if($(e.target).closest("a").length){return true}else{window.location=url}}e.preventDefault();$(e.target).closest(".movies_table_cell_content").removeClass("unread_comment");loadingGifOnElement($(e.target).closest(".movies_table"),true);loadingGifOnElement($(e.target).closest(".movies_alt_view"),true);$.post(basedir+"ajax/get_movie_dialog",{id:id},function(data){if($(e.target).closest(".movie_box").find("iframe").length>0){restartIframe($(e.target).closest(".movie_box").find("iframe"))}refreshBrowserUrl(url);$("body").addClass("stop-scrolling");var movie_inner=$("<div/>").attr("id","movie_dialog_inner").html(data);var movie=$("<div/>").attr("id","movie_dialog").prepend(movie_inner);$("#content").prepend(movie)}).always(function(){loadingGifOnElement($(e.target).closest(".movies_table"),false);loadingGifOnElement($(e.target).closest(".movies_alt_view"),false)});if(!$("html").data("modified-back-btn")){addBackBtnListener()}}function restartIframe(iframe){if(iframe.attr("src")!=null){var frame_url=iframe.attr("src");iframe.attr("src",null);iframe.data("src",frame_url);iframe.attr("src",frame_url)}}function addBackBtnListener(){window.addEventListener("popstate",function(){if($("#movie_dialog").length>0){backHomepageMovie()}else{window.location=document.referrer}},false);$("html").data("modified-back-btn",true)}function stdBtnChangeContent(type){if(type=="edit"){$("#submit_button_hall span").text(vblang("global.edit"));$("#submit_button_hall").removeClass("button-default").addClass("button-light-gray");$("#submit_button_hall i").removeClass("fa-plus").addClass("fa-pencil")}else if(type=="add"){$("#submit_button_hall span").text(vblang("global.add"));$("#submit_button_hall").removeClass("button-light-gray").addClass("button-default");$("#submit_button_hall i").removeClass("fa-pencil").addClass("fa-plus")}}function addTransferAjax(player_id,club_from_id,club_to_id,gender,season_id,link,edited_transfer_id,submit_btn,type){$.ajax({type:"POST",url:basedir+"ajax/add_transfer",data:{player_id:player_id,club_from:club_from_id,club_to:club_to_id,gender:gender,season_id:season_id,link:link,edited_transfer_id:edited_transfer_id,type:type},success:function(data){globalLockUnlockSubmit(false,submit_btn);if(data=="1"){submit_btn.trigger("addedTransferEvent",[type])}},error:function(){globalLockUnlockSubmit(false,submit_btn);showInfoDialog(vblang("error.common"),vblang("dialog.error"))}})}function isValidDate(dateString){var regex=/^\d{4}-\d{2}-\d{2}$/;if(!regex.test(dateString)){return false}var date=new Date(dateString);return date&&date.toISOString().slice(0,10)===dateString}function getAddPlayerRules(isSpecialUser){return{type:{required:true,not0:true},gender:{required:true,not0:true},name:{required:true,minlength:2,maxlength:60,validChars:true,latinAlphabet:true},surname:{required:true,minlength:2,maxlength:60,validChars:true,latinAlphabet:true},maiden_name:{minlength:2,maxlength:60,validChars:true,latinAlphabet:true},nickname:{minlength:3,maxlength:60,validChars:true,latinAlphabet:true},country:{not0:true},birthday:{validDate:true},hometown:{minlength:2,maxlength:40,validChars:true,latinAlphabet:true},current_town:{minlength:2,maxlength:40,validChars:true,latinAlphabet:true},position:{not0:{depends:function(){return $("input[name=is_player]").val()=="1"}}},person_type:{required:{depends:function(){return $("input[name=is_player]").val()=="0"}}},height:{digits:true,min:isSpecialUser?0:130,max:260},weight:{digits:true,min:30,max:190},spike:{digits:true,min:180,max:420},block:{digits:true,min:180,max:420},image:{ext:true}}}function getAddPlayerMessages(){return{type:{required:vblang("player.type.required"),not0:vblang("player.type.required")},gender:{required:vblang("error.option"),not0:vblang("error.option")},name:{required:vblang("player.name.required"),minlength:vblang("player.name.minlength"),maxlength:vblang("player.name.maxlength"),validChars:vblang("player.name.validChars"),latinAlphabet:vblang("error.latin_alphabet")},surname:{required:vblang("player.surname.required"),minlength:vblang("player.surname.minlength"),maxlength:vblang("player.surname.maxlength"),validChars:vblang("player.surname.validChars"),latinAlphabet:vblang("error.latin_alphabet")},maiden_name:{minlength:vblang("player.maiden_name.minlength"),maxlength:vblang("player.maiden_name.maxlength"),validChars:vblang("player.maiden_name.validChars"),latinAlphabet:vblang("error.latin_alphabet")},nickname:{minlength:vblang("player.nickname.minlength"),maxlength:vblang("player.nickname.maxlength"),validChars:vblang("player.nickname.validChars"),latinAlphabet:vblang("error.latin_alphabet")},country:{not0:vblang("player.country.not0")},birthday:{validDate:vblang("error.date")},hometown:{minlength:vblang("town.2chars"),maxlength:vblang("town.40chars"),validChars:vblang("town.invalid"),latinAlphabet:vblang("error.latin_alphabet")},current_town:{minlength:vblang("town.2chars"),maxlength:vblang("town.40chars"),validChars:vblang("town.invalid"),latinAlphabet:vblang("error.latin_alphabet")},position:{not0:vblang("error.team_player.position")},person_type:{required:vblang("error.team_player.position")},height:{digits:vblang("player.height.digits"),min:vblang("player.height.min"),max:vblang("player.height.min")},weight:{digits:vblang("player.weight.digits"),min:vblang("player.weight.min"),max:vblang("player.weight.min")},spike:{digits:vblang("player.spike.digits"),min:vblang("player.spike.min"),max:vblang("player.spike.min")},block:{digits:vblang("player.block.digits"),min:vblang("player.block.min"),max:vblang("player.block.min")},image:{ext:vblang("error.file_types")}}}function addLoadingToButton(button,add,show_label){if(add){show_label=typeof show_label!=="undefined"?show_label:true;button.attr("disabled","disabled");button.children("i.fal").hide();button.children("span").hide();if($("#temp-loading-btn-i").length<1){button.append('<i class="fal fa-circle-notch fa-spin fa-3x fa-fw" id="temp-loading-btn-i"></i>'+(show_label?'<span id="temp-loading-btn-span">'+vblang("global.loading")+"</span>":""))}}else{button.removeAttr("disabled");button.children("i.fal").show();button.children("span").show();if($("#temp-loading-btn-i").length>0){$("#temp-loading-btn-i").remove();$("#temp-loading-btn-span").remove()}}}function urlHasParamOrPath(textval){textval=textval.replace(/:\/\//g,"").replace(/\/$/,"");return textval.indexOf("?")>=0&&textval.indexOf("=")>=0||textval.indexOf("/")>=0}function urlTransfersIsAmongBlocked(url){return url.indexOf("volleybox.net")>=0}function getDialogMaxHeight(dialog_element){const viewportHeight=window.visualViewport?window.visualViewport.height:$(window).height();return viewportHeight-viewportHeight*.1-dialog_element.siblings(".ui-dialog-titlebar").outerHeight()-dialog_element.siblings(".ui-dialog-buttonpane").outerHeight()}function validateAddTeamPlayer(submit_btn,isStaff){var form=submit_btn.closest(".add-player-form");form.find("p.errors").remove();form.find("input").css("border-color","");form.find("select").css("border-color","");var player_container=form.find('input[name="player_hid"]');var player_id=player_container.val();var season_from_container=form.find('[name="season_from"]');var season_from=season_from_container.val();var season_to_container=form.find('[name="season_to"]');var season_to=season_to_container.val();var type=form.find('input[name="type"]').val();var link_container=form.find('input[name="link"]');var link=link_container.val();var valid=true;if(player_id==""||player_id=="0"||player_id=="-1"){player_container.siblings(".item_autocompleter").css("border-color","red");player_container.closest("div").append('<p class="errors">'+vblang("player.required")+"</p>");valid=false}if(form.find('[name="position"]').length>0&&!form.find('[name="position"]').val()){form.find('[name="position"]').css("border-color","red");form.find('[name="position"]').closest("div").append('<p class="errors">'+vblang("error.team_player.position")+"</p>");valid=false}if(type=="C"){if(season_from==""||season_from=="0"||season_from=="-1"){season_from_container.css("border-color","red");season_from_container.closest("div").append('<p class="errors">'+vblang("error.team_player.season_frrom")+"</p>");valid=false}if(season_from!=""&&season_from!="0"&&season_to!=""&&season_to!="0"&&parseInt(season_from,10)>parseInt(season_to,10)){season_from_container.css("border-color","red");season_to_container.css("border-color","red");season_to_container.closest("div").append('<p class="errors">'+vblang("error.team_player.season_to")+"</p>");valid=false}if($(".add-link-container").is(":visible")){if(link==null||link==""){link_container.css("border-color","red");link_container.closest("div").append('<p class="errors">'+vblang("error.link.required")+"</p>");valid=false}else if(!validateURL(link)||!urlHasParamOrPath(link)||urlTransfersIsAmongBlocked(link)){link_container.css("border-color","red");link_container.closest("div").append('<p class="errors">'+vblang("error.link.invalid")+"</p>");valid=false}}}if(valid&&(season_from!=""&&season_from!="0"||season_to!=""&&season_to!="0")){var season_id=season_from!=""?season_from:season_to;$.ajax({type:"POST",url:basedir+"ajax/if_player_alive_season",data:{season_id:season_id,player_id:player_id},success:function(data){if(data=="1"){addTeamPlayer(false,isStaff,submit_btn)}else{season_from_container.css("border-color","red");form.append('<p class="errors">'+vblang("player.no_born")+" "+data+".</p>")}}})}else{return valid}}function getTournamentTeamRoster(submit_btn,roster_container,team_id,tournament_id,slide,position,season_id){roster_container.closest(".team_roster").find(".show-team-roster").addClass("clicked");if(submit_btn!=null&&submit_btn.closest(".season-box").find('input[name="season_hid_id"]').length>0){season_id=submit_btn.closest(".season-box").find('input[name="season_hid_id"]').val()}if(!tournament_id&&!season_id){refreshTab()}else{$.ajax({type:"POST",url:basedir+"ajax/get_tournament_team_roster",data:{team_id:team_id,tournament_id:tournament_id,season_id:season_id,position:position},success:function(data){roster_container.html(data);if(slide){roster_container.hide();roster_container.slideDown()}else{roster_container.show()}roster_container.addClass("roster-loaded");if(submit_btn!=null){globalLockUnlockSubmit(false,submit_btn)}$(".item-profile").trigger("expandedRoster")},error:function(){if(submit_btn!=null){globalLockUnlockSubmit(false,submit_btn)}}})}}function addTeamPlayer(doValidate,isStaff,submit_btn){var form=submit_btn.closest(".add-player-form");var team_id=form.find('input[name="team_hid"]').val();var player_id=form.find('input[name="player_hid"]').val();var season_from=form.find('[name="season_from"]').val();var season_to=form.find('[name="season_to"]').val();var connection_id=form.find('input[name="edited_connection"]').val();var tournament_id=form.find('input[name="tournament_id"]').val();var link=form.find('input[name="link"]').val();var position=form.find('[name="position"]').length>0?form.find('[name="position"]').val():null;if(!globalAddingConnection){globalLockUnlockSubmit(true,submit_btn);if(!doValidate||validateAddTeamPlayer(submit_btn,isStaff)){var roster_container=null;if(submit_btn.closest(".team_roster").find(".tournament-team-roster").length>0){roster_container=submit_btn.closest(".team_roster").find(isStaff?".team-roster-table-staff":".team-roster-table-players")}else{roster_container=submit_btn.closest(".season-box").find(isStaff?".team-roster-table-staff":".team-roster-table-players")}$.ajax({type:"POST",url:basedir+"ajax/add_team_player",data:{team_id:team_id,player_id:player_id,season_from:season_from,season_to:season_to,connection_id:connection_id,tournament_id:tournament_id,link:link,position:position,edit_confirmation:null},success:function(data){if(typeof data==="string"){data=JSON.parse(data)}if(data["code"]==1){$("#playerAutocompleter").val("");$("#staffAutocompleter").val("");$('input[name="player_hid"]').val("");$('input[name="link"]').val("");$('[name="position"]').val("");getTournamentTeamRoster(submit_btn,roster_container,team_id,tournament_id,false,position,null)}else{form.append('<p class="errors">'+data["error"]+"</p>")}globalLockUnlockSubmit(false,submit_btn)},error:function(){globalLockUnlockSubmit(false,submit_btn);showInfoDialog(vblang("error.common"),vblang("dialog.error"))}})}else{globalLockUnlockSubmit(false,submit_btn)}}}function validateAddTransfer(player_id,club_from,club_to,link_input,transfer_id,season_id,add_transfer_container,player_container,club_from_container,club_to_container,gender,submit_btn,type){if(globalAddingConnection){return}var link=link_input.val();if(player_container!=null){player_container.css("border-color","")}if(club_from_container!=null){club_from_container.css("border-color","")}club_to_container.css("border-color","");link_input.css("border-color","");add_transfer_container.find("p.errors").remove();var valid=true;if(club_from==""||club_from=="0"||club_from=="-1"){if(club_from_container!=null){club_from_container.css("border-color","red")}add_transfer_container.append('<p class="errors">'+vblang("error.transfer.club_from")+"</p>");valid=false}if(club_to==""||club_to=="0"||club_to=="-1"){if(club_to_container!=null){club_to_container.css("border-color","red")}add_transfer_container.append('<p class="errors">'+vblang("error.transfer.club_to")+"</p>");valid=false}if(valid&&club_from==club_to){if(club_to_container!=null){club_to_container.css("border-color","red")}add_transfer_container.append('<p class="errors">'+vblang("error.transfer.clubs_same")+"</p>")}if(player_id==""||player_id=="0"||player_id=="-1"){if(player_container!=null){player_container.css("border-color","red")}add_transfer_container.append('<p class="errors">'+vblang("player.required")+"</p>");valid=false}if(link==""){link_input.css("border-color","red");add_transfer_container.append('<p class="errors">'+vblang("error.link.required")+"</p>");valid=false}else if(!validateURL(link)||!urlHasParamOrPath(link)||urlTransfersIsAmongBlocked(link)){link_input.css("border-color","red");add_transfer_container.append('<p class="errors">'+vblang("error.link.invalid")+"</p>");valid=false}if(valid){globalLockUnlockSubmit(true,submit_btn);$.ajax({type:"POST",url:basedir+"ajax/if_transfer_exists",data:{season_id:season_id,player_id:player_id,club_to:club_to,edited_transfer_id:transfer_id,type:type},success:function(data){if(data=="1"){addTransferAjax(player_id,club_from,club_to,gender,season_id,link,transfer_id,submit_btn,type)}else if(data=="0"){globalLockUnlockSubmit(false,submit_btn);if(player_container!=null){player_container.css("border-color","")}club_to_container.css("border-color","red");add_transfer_container.append('<p class="errors">'+vblang("error.transfer.exists")+"</p>")}},error:function(){globalLockUnlockSubmit(false,submit_btn)}})}else{return valid}}function validateConfirmingLink(input){var valid=true;var link=input.val();input.closest(".playerConfirm").find("p.errors").remove();input.css("border-color","");if(link==""){input.css("border-color","red");input.closest(".playerConfirm").append('<p class="errors">'+vblang("error.link.required")+"</p>");valid=false}else if(!validateURL(link)||!urlHasParamOrPath(link)||urlTransfersIsAmongBlocked(link)){input.css("border-color","red");input.closest(".playerConfirm").append('<p class="errors">'+vblang("error.link.invalid")+"</p>");valid=false}return valid}function getCloseDialogButton(){return'  <a role="button" tabindex="0" class="button-transparent button-close-dialog">'+'    <i class="fal fa-times-circle fa-lg"></i>'+"    <span>"+vblang("global.close")+"</span>"+"  </a>"}function showInfoDialog(text,dialogTitle){if(!dialogTitle){dialogTitle=vblang("dialog.info")}var dialogId="info-dialog";var buttons=getCloseDialogButton();showInfo(dialogId,dialogTitle,text,null,buttons)}function showUnloggedInfo(text){showLoginDialog(vblang("dialog.only_logged"),text,false)}function showConfirmationDialog(text,url,func){var buttonYesId="button-confirm-yes";var buttonNoId="button-confirm-no";var dialogId="confirm-info-dialog";$(document).off("click","#"+buttonYesId);$(document).off("click","#"+buttonNoId);$(document).on("click","#"+buttonYesId,function(){if(typeof func==="function"){$("#"+dialogId).dialog("close");func()}else{globalLockUnlockSubmit(true,$(this));window.location=url}});$(document).on("click","#"+buttonNoId,function(){$("#"+dialogId).dialog("close")});var buttons='<a role="button" tabindex="0" id="'+buttonNoId+'" class="marginRight5 button-standard button-transparent">'+'  <i class="fal fa-ban fa-lg"></i>'+"  <span>"+vblang("global.no")+"</span>"+"</a>"+'<a role="button" tabindex="0" id="'+buttonYesId+'" class="marginLeft5 button-standard button-default">'+'  <i class="fal fa-check fa-lg"></i>'+"  <span>"+vblang("global.yes")+"</span>"+"</a>";showInfo("confirm-info-dialog",vblang("confirm.sure_title"),text,null,buttons)}function showInfo(dialogId,dialogTitle,text,additionalText,buttons){var dialogElement=$("#"+dialogId);if(dialogElement.length<1){var html='<div id="'+dialogId+'" style="display: none;">'+'  <div class="box_info">'+(text!=null?'<p class="big_info tac" id="'+dialogId+'-par1">'+text+"</p>":"")+(additionalText?'<p class="big_info tac" id="'+dialogId+'-par2">'+additionalText+"</p>":"")+'    <div style="height: 10px" class="bottom_dotted_line marginBottom10"></div>'+"  </div>"+'  <div class="tac marginTop10">'+buttons+"</div>"+"</div>";$("body").append(html);addUniversalDialogForElement($("#"+dialogId),dialogTitle,true,null,true)}else{$("#"+dialogId+"-par1").html(text);openDialog(dialogElement)}}function getCreateClubDialogId(){return"create_club"}function getCreatePlayerDialogId(){return"create_player"}function getCreateStaffDialogId(){return"create_staff"}function getCreateHallDialogId(){return"create_hall"}function getCreateTournamentDialogId(){return"create_tournament"}function addUniversalDialog(dialog_id,title,closeClickOutside,dialogClass,width,height){var dialog$=$("#"+dialog_id);if(dialog$.length>0){dialog$.remove()}var dialog_element=$(document.createElement("div"));dialog_element.attr("id",dialog_id);dialog_element.css("display","none");var dialog_element_inside=$("<div/>").css("height","100px");dialog_element.html(dialog_element_inside);loadingGifOnElement(dialog_element_inside,true);addUniversalDialogForElement(dialog_element,title,closeClickOutside,dialogClass,false,width,height)}function addUniversalDialogForElement(dialog_element,title,closeClickOutside,dialogClass,autoOpen,width,height){if(!width){width="640px"}if(!height){height="auto"}if(dialog_element!=null&&dialog_element.length>0){dialog_element.dialog({title:title,show:"fade",hide:"fade",autoOpen:autoOpen,modal:true,height:height,width:width,position:"center",resizable:false,draggable:false,dialogClass:dialogClass,open:function(){if(closeClickOutside){$(".ui-widget-overlay").bind("click",function(){dialog_element.dialog("close")})}$(this).css("max-height",getDialogMaxHeight(dialog_element)+"px");$("body").addClass("stop-scrolling");centerDialog(dialog_element);if(dialog_element.find("iframe").length>0){dialog_element.find("iframe").load(function(){centerDialog(dialog_element)})}else if(dialog_element.find("img").length>0){var loaded_images_count=0;dialog_element.find("img").load(function(){loaded_images_count++;if(loaded_images_count==dialog_element.find("img").length){centerDialog(dialog_element)}})}else{centerDialog(dialog_element)}setTimeout(function(){centerDialog(dialog_element);if(autoOpen&&inIframe()){dialog_element.closest(".ui-dialog").show().css("z-index",101)}},1e3)},close:function(){$("body").removeClass("stop-scrolling")}});dialog_element.on("dialogclose",function(){$("body").removeClass("stop-scrolling")});$(document).on("ajaxStop",function(){dialog_element.css("max-height",getDialogMaxHeight(dialog_element)+"px");centerDialog(dialog_element)});$(window).bind("resize scroll",function(){if(dialog_element.length>0&&dialog_element.hasClass("ui-dialog-content")&&dialog_element.dialog("isOpen")){setTimeout(function(){dialog_element.css("max-height",getDialogMaxHeight(dialog_element)+"px");centerDialog(dialog_element)},1)}})}}function addCreateClubDialog(){var dialog_id=getCreateClubDialogId();addUniversalDialog(dialog_id,vblang("dialog.club"),false,null)}function addCreatePlayerDialog(){var dialog_id=getCreatePlayerDialogId();addUniversalDialog(dialog_id,vblang("dialog.player"),false,null)}function addCreateStaffDialog(){var dialog_id=getCreateStaffDialogId();addUniversalDialog(dialog_id,vblang("dialog.staff"),false,null)}function addCreateHallDialog(){var dialog_id=getCreateHallDialogId();addUniversalDialog(dialog_id,vblang("dialog.arena"),false,null)}function addCreateTournamentDialog(){var dialog_id=getCreateTournamentDialogId();addUniversalDialog(dialog_id,vblang("dialog.tournament"),false,null)}function createClubDialogLoadContent(town,country,gender,age){createUniversalDialogLoadContent(getCreateClubDialogId(),{tabName:"club",ajaxSubmit:true,town:town,country:country,gender:gender,age:age},"add_item")}function createStaffDialogLoadContent(type,gender,country){createUniversalDialogLoadContent(getCreateStaffDialogId(),{tabName:"staff",ajaxSubmit:true,type:type,gender:gender,country:country},"add_item")}function createPlayerDialogLoadContent(type,gender,country){createUniversalDialogLoadContent(getCreatePlayerDialogId(),{tabName:"player",ajaxSubmit:true,type:type,gender:gender,country:country},"add_item")}function createHallDialogLoadContent(country,type){createUniversalDialogLoadContent(getCreateHallDialogId(),{tabName:"arena",ajaxSubmit:true,country:country,type:type},"add_item")}function createTournamentDialogLoadContent(gender,ground,type,age){createUniversalDialogLoadContent(getCreateTournamentDialogId(),{tabName:"tournament",ajaxSubmit:true,gender:gender,ground:ground,type:type,age:age},"add_item")}function createUniversalDialogLoadContent(dialog_id,data,ajaxRequest){var dialog_element=$("#"+dialog_id);openDialog(dialog_element);dialog_element.load(basedir+"ajax/"+ajaxRequest,data,function(){dialog_element.trigger("dialogContentLoaded");if(dialog_element.find("img").length>0){var loaded_images_count=0;dialog_element.find("img").load(function(){loaded_images_count++;if(loaded_images_count==dialog_element.find("img").length){centerDialog(dialog_element)}})}dialog_element.css("max-height",getDialogMaxHeight(dialog_element)+"px");centerDialog(dialog_element)})}let refreshItemsListLastData="";let refreshItemsListLastPage="";function refreshItemsList(page,isScroll,url,addQueryParam){page=page==null?1:page;const serializedData=$(".main_dropdowns_lists").serialize();if(page===refreshItemsListLastPage&&serializedData===refreshItemsListLastData){return}refreshItemsListLastData=serializedData;refreshItemsListLastPage=page;var ajaxLoadedList=$(".ajax-loaded-list");var ajaxScrolled=$(".ajax-scrolled");loadingGifOnElement(ajaxLoadedList,true);if($(".applied-filters").length){$(".applied-filters").addClass("comments_transparent")}ajaxLoadedList.data("page",page);if(ajaxScrolled.length>0){ajaxScrolled.data("lockajaxloading",false)}$.ajax({type:"POST",url:basedir+"ajax/"+ajaxLoadedList.data("url")+"/"+page+(addQueryParam?"?page="+page:""),data:serializedData,success:function(data){ajaxLoadedList.html(data);if(isScroll){scroll_to_element(ajaxLoadedList)}else{loadingGifOnElement(ajaxLoadedList,false);if($(".applied-filters").length){$(".applied-filters").removeClass("comments_transparent")}}const items_count=$("#items_count_hid").val();if(items_count&&items_count>0){$("#items_count").text(items_count)}if(url){refreshBrowserUrl(url)}else{const currentUrlWithoutParams=window.location.origin+window.location.pathname;const filteredData=serializedData.split("&").filter(pair=>{const[key,value]=pair.split("=");return value&&value!="0"}).join("&");refreshBrowserUrl(currentUrlWithoutParams+"?"+filteredData)}ajaxLoadedList.trigger("refreshAjaxItemListEvent")}})}function installRefreshingItemsList(){$(".main_dropdowns_lists input:not(.dynamically-refreshed)").keypress(function(event){if(event.which==13){event.preventDefault();refreshItemsList(null,false,null,true)}});$(".main_dropdowns_lists input, .main_dropdowns_lists select").keypress(function(event){if(event.which==13){event.preventDefault();return false}});$("#countryAutocompleter").on("selectedItemEvent",function(){refreshItemsList(null,false,null,true)});$(".main_dropdowns_lists select:not(.gender-switcher):not(.dynamically-refreshed), .main_dropdowns_lists input:not(.dynamically-refreshed)").change(function(){refreshItemsList(null,false,null,true)});var drowdownLists$=$(".ajax-loaded-list-tabs li");$(".ajax-loaded-list-tabs li p a").click(function(e){e.preventDefault();var liElement=$(this).parent("p").parent("li");if(liElement.hasClass("desc")){liElement.toggleClass("desc asc")}else if(liElement.hasClass("asc")){liElement.toggleClass("asc desc")}else{drowdownLists$.removeClass("desc").removeClass("asc");liElement.addClass("desc")}drowdownLists$.removeClass("active");$(this).closest("li").addClass("active");var orderValue=$(".ajax-loaded-list-tabs li.active a").attr("id");var orderDirection=$(".ajax-loaded-list-tabs li.active").hasClass("desc")?"desc":"asc";$('.main_dropdowns_lists input[name="orderValue"]').val(orderValue);$('.main_dropdowns_lists input[name="orderDirection"]').val(orderDirection);refreshItemsList(null,false,null,true)});var refreshingItemsTimeoutCreate;$("input.dynamically-refreshed").bind("keyup input paste",function(){if(refreshingItemsTimeoutCreate!=null){clearTimeout(refreshingItemsTimeoutCreate)}refreshingItemsTimeoutCreate=setTimeout(function(){refreshItemsList(null,false,null,true)},500)});addAjaxPagination()}function addAjaxPagination(){$(document).on("click",".ajax-loaded-list .pagination a",function(event){event.preventDefault();var h=$(this).attr("href");if(h){const url=new URL(h);let page=url.searchParams.get("page");if(!page){page=h.substring(h.lastIndexOf("/")+1)}refreshItemsList(page,true,h,true)}})}var loadingAjaxScrolled=false;var lastLoadedTabName=null;function loadScrolledContent(form,data){if(form!=null){addParametersToObject(form,data)}var ajaxTabs$=$(".ajax-tabs");var ajaxScrolled$=$(".ajax-scrolled");data["tabName"]=ajaxTabs$.data("choosed");if(lastLoadedTabName!=data["tabName"]){ajaxScrolled$.data("page",1)}lastLoadedTabName=data["tabName"];loadingAjaxScrolled=true;var page=parseInt(ajaxScrolled$.data("page"),10)+1;data["page"]=page;var url=null;if($(".ajax-loaded-list-tabs").length>0){url=$(".ajax-loaded-list-tabs").data("ajax-url")}else if(ajaxTabs$.length>0){url=ajaxTabs$.data("ajax-url")}else{url=ajaxScrolled$.data("url")}ajaxScrolled$.append('<div class="loading-info"><i class="fal fa-circle-notch fa-spin fa-3x fa-fw"></i><span>'+vblang("global.loading")+"</span></div>");$.ajax({type:"POST",url:basedir+"ajax/"+url,data:data,success:function(data){loadingAjaxScrolled=false;if(ajaxScrolled$.find(".ajax-scrolled-inside").length>0){ajaxScrolled$.find(".ajax-scrolled-inside").append(data)}else{ajaxScrolled$.append(data)}ajaxScrolled$.data("page",page);ajaxScrolled$.find(".loading-info").remove();if(data==""){ajaxScrolled$.data("lockajaxloading",true)}ajaxScrolled$.trigger("loadedContent")}})}function installAjaxScrolledContent(){var ajaxScrolled$=$(".ajax-scrolled");if(ajaxScrolled$.length>0){var data={};var form=null;var ajaxTabs$=$(".ajax-tabs");var mainDropdowns$=$(".main_dropdowns_lists");if(ajaxTabs$.find(".tabs-parameters").length>0){form=ajaxTabs$.find(".tabs-parameters")}else if(mainDropdowns$.length>0){form=mainDropdowns$}$(document).on("click",".ajax-scrolled-trigger-btn",function(){loadScrolledContent(form,data)});$(document).scroll(function(){if(!loadingAjaxScrolled&&!ajaxScrolled$.data("lockajaxloading")){if(ajaxScrolled$.find(".movies_table .movies_table_cell").length>0&&isScrolledIntoView(ajaxScrolled$.find(".movies_table:last-child .movies_table_cell:last-child"))||ajaxScrolled$.find(".movie_box").length>0&&isScrolledIntoView(ajaxScrolled$.find(".movie_box:last"))||ajaxScrolled$.find(".scrolled-box").length>0&&isScrolledIntoView(ajaxScrolled$.find(".scrolled-box:last"))||$(".users-comments-page .ajax-scrolled .comment_box").length>0&&isScrolledIntoView($(".users-comments-page .ajax-scrolled .comment_box:last"))){loadScrolledContent(form,data)}}})}}function installProfileLeftSlideBox(){$(document).on("click",".profile-left-slide-box h2, .profile-left-slide-box i.fa-angle-down, .profile-left-slide-box i.fa-angle-up",function(){var leftSlideBox=$(this).closest(".profile-left-slide-box");if(leftSlideBox.find(".profile-left-slide-container").is(":visible")){leftSlideBox.find(".profile-left-slide-container").slideUp(400,function(){showVisibleImages($(".profile-left-slide-container:visible .image-load-container"))});leftSlideBox.removeClass("clicked")}else{leftSlideBox.find(".profile-left-slide-container").slideDown(400,function(){showVisibleImages($(".profile-left-slide-container:visible .image-load-container"))});leftSlideBox.addClass("clicked")}})}function ifTournamentExists(element,value,id){var exists=false;var tournament_id=$(element).closest("form").find("input[name=tournament_id]").val();if(value!=""&&tournament_id!=""){$.ajax({url:basedir+"ajax/if_tournament_exists/"+tournament_id+"/"+value+(id!=-1?"/"+id:""),data:{},async:false,success:function(msg){exists=msg==="1";return exists}})}return exists}function openDialogCreate(tournament_type_id,tournament_id,season_id,qualifications){addUniversalDialog("new_edition",qualifications?vblang("dialog.qual_tournament"):vblang("dialog.tournament_edition"),false,null);createUniversalDialogLoadContent("new_edition",{tournament_type_id:tournament_type_id,season_id:season_id,qualifications:qualifications?1:0,tournament_id:tournament_id},"get_new_edition_dialog")}function expandBodyOnOpenCloseAutocomplete(autocomplete,isOpen){var borderElement=$("footer");var containerElement=$("#container");var isDialog=autocomplete.closest(".ui-dialog-content").length>0;if(isDialog){borderElement=autocomplete.closest(".ui-dialog-content").children().last();containerElement=autocomplete.closest(".ui-dialog-content")}if(containerElement.hasClass("main-container-height-100")){return}if(!autocomplete||borderElement.length<1){return}var autocompleteHeight=autocomplete.height();var autocompleteBottomEdge=autocomplete.offset().top+autocompleteHeight;if(isOpen&&autocompleteBottomEdge<borderElement.offset().top){return}var bodyCurrentPadding=parseInt(containerElement.css("padding-bottom"),10);if(!bodyCurrentPadding){bodyCurrentPadding=0}var newPadding=0;if(isOpen){if(!containerElement.data("original-padding")){containerElement.data("original-padding",bodyCurrentPadding)}newPadding=containerElement.data("original-padding")+autocompleteHeight}else{newPadding=containerElement.data("original-padding")}if(!isDialog&&newPadding<borderElement.height()){return}containerElement.css("padding-bottom",newPadding);if(isDialog){centerDialog(autocomplete.closest(".ui-dialog-content"))}}function confirmRedirect(message,e){e.preventDefault();var url=$(e.target).attr("href");if(!url){url=$(e.target).closest("a").attr("href")}if(url&&url!="#"&&url!="#0"){showConfirmationDialog(message,url)}}function confirmFunction(message,func){showConfirmationDialog(message,null,func)}function showReplyForm(id,author,author_nick){if(userId=="0"){showUnloggedInfo(vblang("logged.comment_reply"))}else{var addCommment$=$("div.add_comment");var comment$=$("#comment_"+id);if(addCommment$.hasClass("review-comment")&&isMobile!="true"){addCommment$.appendTo(comment$)}else{addCommment$.appendTo(comment$.closest(".new_box"))}$(".add-reply-form-container").removeClass("display-none");addCommment$.addClass("replyComment fake-padding");addCommment$.removeClass("display-none");$("div.add_comment .addCommentAvatarContainer").removeClass("big-online-user");var mainParentId=comment$.data("parent-main-id");var parentId=comment$.data("parent-id");var finalParentId=mainParentId==0?parentId==0?id:parentId:mainParentId;var parentUserId=comment$.data("parent-user-id");setCommentParentValues(finalParentId,id,author,parentUserId);var body$=$("body");body$.data("ckeditor-author",author);body$.data("ckeditor-author-nick",author_nick);body$.data("ckeditor-parent-user-id",parentUserId);showAddCommentForm($("#add-comment-form-trigger"),function(){if(myCKEditor&&(author||parentUserId)){myCKEditor.execute("mention",{marker:"@",mention:{id:"@"+author.replace(/\s/g,""),userId:parentUserId,type:"U",nick:author_nick,link:"/user/"+author_nick}});loadingGifOnElement($("#add_reply_form"),false)}})}}function setCommentParentValues(finalParentId,id,author,parentUserId){$("input[name=parent_main_id]").val(finalParentId);$("input[name=parent_id]").val(id);$("input[name=parent_nick]").val(author);$("input[name=parent_user_id]").val(parentUserId)}function deleteComment(clicked){var type=clicked.closest(".comment_box").data("type");confirmFunction(vblang("confirm.delete_comment"),function(){var comment_id=clicked.closest(".comment_box").data("id");if($("#comment_"+comment_id).length<1){return}var methodName=null;var fieldName=null;if(type=="transfer"){methodName="delete_transfer_comment";fieldName="post_id="}else if(type=="topic"||type=="forum_topic"){methodName="delete_post";fieldName="post_id="}else if(type=="movie"){methodName="delete_comment";fieldName="comment_id="}else if(type=="link"){methodName="delete_link_comment";fieldName="comment_id="}else if(type=="tournament"){methodName="delete_tournament_comment";fieldName="comment_id="}else if(type=="chat"){methodName="delete_chat_message";fieldName="comment_id="}else if(type=="agency_review"){methodName="delete_agency_review_comment";fieldName="comment_id="}else if(type=="team_review"){methodName="delete_team_review_comment";fieldName="comment_id="}$.post(basedir+"ajax/"+methodName,fieldName+comment_id,function(data){var response_code=$("response code",data).text();var commentBox$=clicked.closest(".comment_box");var commentsAmount$=$("#comments_amount");if(response_code=="1"){if(commentBox$.hasClass("replyComment")){commentBox$.remove()}else{commentBox$.parent(".new_box").remove()}}else if(response_code=="0"){commentBox$.find(".comment_body").addClass("removedBody").html(vblang("global.removed_comment"));commentBox$.find(".comment_edit").remove()}if(commentsAmount$.length>0){commentsAmount$.text(parseInt(commentsAmount$.text(),10)-1)}})})}function addComment(input){var type=$(".add-comment-form").data("type");var methodName=null;if(type=="transfer"){methodName="add_comment_transfer"}else if(type=="topic"||type=="forum_topic"){methodName="add_comment_topic"}else if(type=="movie"){methodName="add_comment"}else if(type=="link"){methodName="add_link_comment"}else if(type=="agency_review"){methodName="add_agency_review_comment"}else if(type=="team_review"){methodName="add_team_review_comment"}else if(type=="tournament"){methodName="add_tournament_comment"}else if(type=="chat"){methodName="live_chat_post/0"}var ta=myCKEditor.getData();var parent_main=$("input[name=parent_main_id]").val();if($.trim(ta).length<2){showInfoDialog(vblang("error.comment_too_short"),vblang("dialog.error"));return false}addLoadingToButton(input,true);var data={comment:ta};addParametersToObject($("#add_reply_form"),data);$.post(basedir+"ajax/"+methodName,data,function(data){addLoadingToButton(input,false);if($(".new_comment").length>0){$(".new_comment").removeClass("new_comment")}if(parent_main&&parent_main!=""&&parent_main!=null){$('<div class="new_comment">'+data+"</div>").insertBefore($(".add_comment"))}else if($("#comments .comment-discussion-container").length>0){if(type=="forum_topic"){$("#comments .comment-discussion-container").append('<div class="new_box new_comment">'+data+"</div>")}else{$("#comments .comment-discussion-container").prepend('<div class="new_box new_comment">'+data+"</div>")}}else{$('<div class="new_box new_comment'+(type=="chat"&&isMobile=="true"?" padding0":"")+'">'+data+"</div>").insertAfter($("#add_reply_form").closest(".new_box"))}$(".new_comment").eq(0).fadeIn(300);if($("#comments_amount").length>0){$("#comments_amount").text(parseInt($("#comments_amount").text())+1)}setCommentParentValues("","","","");$("div.add_comment.replyComment").removeClass("replyComment fake-padding");if(type=="forum_topic"){$("div.add_comment .addCommentAvatarContainer").addClass("big-online-user")}$("div.add_comment").prependTo(".add-comment-form-container");myCKEditor.setData("");showVisibleImages($(".image-load-container"));openPushPrePermissionDialog(vblang("question.notification"));initializeMediaObjects();$("#add_reply_form").trigger("newItemAdded")}).fail(function(){addLoadingToButton(input,false);showInfoDialog(vblang("error.common"),vblang("dialog.error"))})}edit_lock="off";function editComment(input){var type=input.closest(".comment_box").data("type");var getCommentMethod=null;var saveCommentMethod=null;if(type=="transfer"){getCommentMethod="get_edit_transfer_comment";saveCommentMethod="edit_transfer_comment"}else if(type=="topic"||type=="forum_topic"){getCommentMethod="get_edit_post";saveCommentMethod="save_post"}else if(type=="movie"){getCommentMethod="get_edit_comment";saveCommentMethod="save_comment"}else if(type=="link"){getCommentMethod="get_edit_link_comment";saveCommentMethod="edit_link_comment"}else if(type=="tournament"){getCommentMethod="get_edit_tournament_comment";saveCommentMethod="edit_tournament_comment"}else if(type=="chat"){getCommentMethod="get_edit_chat_comment";saveCommentMethod="edit_chat_comment"}if(edit_lock=="on"){showInfoDialog(vblang("global.end_edition"));return false}edit_lock="on";var comment_id=input.closest(".comment_box").data("id");var parent_user_id=input.closest(".comment_box").data("parent-user-id");$.post(basedir+"ajax/"+getCommentMethod,{comment_id:comment_id},function(data){var body$=$("body");body$.data("ckeditor-author",null);body$.data("ckeditor-author-nick",null);body$.data("ckeditor-parent-user-id",null);var comment=input.parent(".comment_edit").siblings(".comment_body_content");comment.toggle();var editbox=$("<div></div>").addClass("edit");editbox.append(data);comment.after(editbox);var editbuttons=input.closest(".comment_edit");editbuttons.toggle();var eb2=$("<div></div>").addClass("comment_edit").addClass("edition-options").attr("id","edition_button_"+comment_id).css("display","block");var cancel=$("<a>Cancel</a>").click(function(){editbox.remove();comment.toggle();eb2.remove();editbuttons.toggle();edit_lock="off"});var save=$("<a>Save</a>").click(function(){var comment_value=myCKEditor.getData();$.post(basedir+"ajax/"+saveCommentMethod,{comment_id:comment_id,parent_id:parent_user_id,comment:comment_value},function(data){comment.html(data);editbox.remove();comment.toggle();eb2.remove();editbuttons.toggle();edit_lock="off";showVisibleImages($(".image-load-container"))})});eb2.append(cancel).append(save);editbuttons.after(eb2);$("#edition_button_"+comment_id).css("height","auto").css("position","static");initializeMediaObjects();showVisibleImages($(".image-load-container"))})}function removeEmptyFilesFormData(formData,form){form.find('input[type="file"]').each(function(){if($(this)!=null&&$(this).get(0).files.length==0){formData.delete($(this).attr("name"))}})}function showAddFavoriteForm(input){var items_list=input.closest(".favorite_items").find(".items_list");if(items_list.find(".item_box").length>0){input.closest(".favorite_items").find(".add_connection_cnt").insertBefore(items_list.find(".item_box:first"))}else{items_list.html(input.closest(".favorite_items").find(".add_connection_cnt"))}input.closest(".favorite_items").find(".add_connection_cnt").addClass("item_box padding0 paddingTop15 paddingBottom15").removeClass("left").removeClass("div-1-3").show();input.hide()}function showHideMobileSubitems(category){var mobileSubitems$=$("#"+category+"_mobile_subitems");if(mobileSubitems$.is(":visible")){$("#mobile_"+category+"_trigger").closest("li").find("i.icon-show-subcategories").removeClass("open-icon");mobileSubitems$.slideUp("slow")}else{$("#mobile_"+category+"_trigger").closest("li").find("i.icon-show-subcategories").addClass("open-icon");mobileSubitems$.show();mobileSubitems$.hide().slideDown("slow")}}function hideLeftMenu(){$(".mobileMenuImg").removeClass("is-active");if(isMobile=="true"){var mobileLeft$=$("#mobileLeftMenu");$("#footer").animate({left:"0px"},{duration:400,queue:false,complete:function(){mobileLeft$.css("overflow-y","visible");mobileLeft$.hide();$(".ui-widget-overlay-mobile-menu").fadeOut().remove()}});mobileLeft$.animate({left:"-230px"},{duration:400,queue:false})}else{var menuCategories=$(".menu-categories");menuCategories.show();menuCategories.animate({left:"-250px"},{duration:400,queue:false,complete:function(){menuCategories.css("overflow-y","visible");menuCategories.hide();$(".ui-widget-overlay-mobile-menu").fadeOut().remove()}});menuCategories.css("overflow-y","scroll")}$("body").removeClass("stop-scrolling");menuVisible=false}function showSearchMobile(){var that=$(this);var movieDialog$=$("#movie_dialog");if(!that.data("loading")&&(movieDialog$.length<0||!movieDialog$.hasClass("search-page"))){that.data("loading",true);$.post(basedir+"ajax/get_search_trigger",function(data){refreshBrowserUrl(basedir+"search");$("body").addClass("stop-scrolling");var movie_inner=$("<div/>").attr("id","movie_dialog_inner").html(data);$("#movie_dialog").remove();var movie=$("<div/>").attr("id","movie_dialog").addClass("search-page").prepend(movie_inner);if($(".about-project-container").length>0){$(".about-project-container").prepend(movie)}else{$("body").prepend(movie)}}).always(function(){that.data("loading",false)});if(!$("html").data("modified-back-btn")){addBackBtnListener()}}}function closeSearchMobile(){if($(".about-project-container").length>0){$(".about-project-container").children(".left_reset_float").show()}else{$("#content").children(".left_reset_float").show()}$("#right_side").show();$(".header-container,#header-container").show();$("#itemSearchMobile").parent("div").hide();$("#itemSearchMobileResults").hide()}function installSearchItemsMobile(){$("body").bind("touchmove scroll",function(){$("#itemSearchMobile").blur()});$("#itemSearchMobile").bind("blur",function(){setTimeout(function(){showVisibleImages($(".image-load-container"))},500)})}function searchItemsMobile(){var searchValue=$("#itemSearchMobile").val();if(searchValue==null||searchValue==""||searchValue.length<2){return}var itemSearchMobileResults$=$("#itemSearchMobileResults");var searchContainer$=$(".item-search-container");itemSearchMobileResults$.show();searchContainer$.find("i.search-spinner-icon").show();searchContainer$.find("i.fa-search").hide();itemSearchMobileResults$.load(basedir+"ajax/get_search_view",{query:searchValue,searchedItems:"arenas,players,teams,tags,tournaments,users,staff,agencies",ground:'"'+groundGlobal+'"',gender:genderGlobal,mainSearchRequest:true,limitSubitems:6},function(){searchContainer$.find("i.search-spinner-icon").hide();searchContainer$.find("i.fa-search").show()})}function installHidingLeftMenu(){$(document).click(function(event){if(menuVisible&&event.target.id!=="mobileLeftMenu"&&!$(event.target).closest("nav").hasClass("mobileLeftMenu")&&!$(event.target).hasClass("mobileMenuImg")&&!$(event.target).closest("button").hasClass("mobileMenuImg")&&!$(event.target).hasClass("ui-autocomplete")&&!$(event.target).closest("ul").hasClass("ui-autocomplete")){hideLeftMenu()}})}function installMobileMenu(){var refreshingSearchItemTimeoutCreate;$(".main_logo").click(function(){$(".websites-picker li.active").removeClass("active");$(this).closest("li").addClass("active")});$("#mobileLeftMenu li.main-category").click(function(){$("#mobileLeftMenu li.main-category.active").removeClass("active");$("#mobileLeftMenu li.has-subcategory.active").removeClass("active");$(this).addClass("active")});$("#mobileLeftMenu li.sub-category").click(function(){$("#mobileLeftMenu li.main-category.active").removeClass("active");$("#mobileLeftMenu li.has-subcategory.active").removeClass("active");$('#mobileLeftMenu li[data-category="'+$(this).closest("ul").data("super-category")+'"]').addClass("active")});$("#mobileLeftMenu li.category.has-subcategory").click(function(){var category=$(this).data("category");if(!category){category=$(this).closest("li.category").data("category")}showHideMobileSubitems(category)});installSearchItemsMobile();$("#itemSearchMobile").bind("keyup input paste",function(){if(refreshingSearchItemTimeoutCreate!=null){clearTimeout(refreshingSearchItemTimeoutCreate)}refreshingSearchItemTimeoutCreate=setTimeout(function(){searchItemsMobile()},500)});$(".close-search-mobile").click(function(){closeSearchMobile()})}function readUserPmAjax(id){$.post(basedir+"ajax/read_user_pm",{pm_id:id},function(){if(id!==null){var removed=$("#pm_ajax_"+id);removed.closest(".new").removeClass("new");removed.parent(".pm_ajax_content").find("a.read").remove()}else{$(".user_inbox_window div.new").removeClass("new");$(".user_inbox_window .right_box a.read").remove()}update_msg_cnt()});return false}var gLastScrollOffsetInbox=1;var gLastScrollOffsetActions=1;function installInboxAjax(){var loadingInbox=false;$(".usr_inbox_box").scroll(function(){if(!loadingInbox&&$(".usr_inbox_box .pm_ajax:nth-last-child(5)").length>0&&$(".usr_inbox_box").length>0&&$(".usr_inbox_box .pm_ajax:nth-last-child(5)").offset().top<$(".usr_inbox_box").offset().top+$(".usr_inbox_box").height()){loadingInbox=true;gLastScrollOffsetInbox=gLastScrollOffsetInbox+1;$.post(basedir+"ajax/get_user_pms_list",{page:gLastScrollOffsetInbox},function(data){loadingInbox=false;$(".usr_inbox_box").append(data);updateScrollbar(ps_menu_inbox)})}});$(document).on("click",".user_inbox_window .pm_ajax",function(event){var elem=$(this);if(event.target.nodeName!=="A"&&event.target.nodeName!=="I"){window.location=elem.data("url")}})}function installActionsAjax(){var loadingActions=false;$(".usr_actions_box").scroll(function(){if(!loadingActions&&$(".usr_actions_box .action:nth-last-child(5)").length>0&&$(".usr_actions_box").length>0&&$(".usr_actions_box .action:nth-last-child(5)").offset().top<$(".usr_actions_box").offset().top+$(".usr_actions_box").height()){loadingActions=true;gLastScrollOffsetActions=gLastScrollOffsetActions+1;$.post(basedir+"ajax/get_user_actions_list",{page:gLastScrollOffsetActions},function(data){loadingActions=false;$(".usr_actions_box").append(data);updateScrollbar(ps_menu_actions)})}});$(document).on("click",".usr_actions_box .action",function(e){var selected=[];selected.push($(this).data("action-id"));readUserActionAjax(selected,"");if(!$(e.target).hasClass("read-icon")){var link=$(this).find(".pm_ajax_content").find(".action_text").find("a").last().attr("href");if(link&&link!=""&&link!==undefined){window.location=link}}});$(document).on("click",".action .action_text a",function(){var href=$(this).attr("href");$(this).removeAttr("href");var id=$(this).parent("span.action_text").attr("id");if(id){id=id.substring(7)}var selected=[];selected.push(id);readUserActionAjax(selected,href)})}function readUserActionAjax(id,href){$.post(basedir+"ajax/read_user_action",{action_id:id},function(){if(id!==null){$.each(id,function(index,value){var removed=$("#action_"+value);removed.closest(".new").removeClass("new");removed.parent("div.left").find("a.read").remove()})}else{$(".usr_actions_box div.new").removeClass("new");$(".usr_actions_box a.read").remove()}if(href!==""){window.location=href}update_actions_cnt()});return false}function openReportDuplicate(itemType,itemId,data){addUniversalDialog("report_duplicate",vblang("dialog.report_duplicate"),true,null,false);createUniversalDialogLoadContent("report_duplicate",data,"get_report_duplicate_dialog/"+itemType+"/"+itemId)}function showReportDuplicateError(element,errorMessage){element.addClass("formError");element.append('<p class="errors">'+errorMessage+"</p>")}function openReportTransfer(transferId){addUniversalDialog("report_incorrect_transfer",vblang("dialog.report_transfer"),true,null,false);createUniversalDialogLoadContent("report_incorrect_transfer",{},"get_report_transfer_dialog/"+transferId)}function getVmChart(dataValues,labelValues,elementId,maintainAspectRatio){var colorHex=groundGlobal=="B"?"#ea9e41":genderGlobal=="W"?"#f64e7a":"#fd5f38";var colorRgb=hexToRgb(colorHex);var data={labels:labelValues,datasets:[{backgroundColor:"rgba("+colorRgb.r+", "+colorRgb.g+", "+colorRgb.b+", 0.2)",borderColor:"rgba("+colorRgb.r+", "+colorRgb.g+", "+colorRgb.b+", 1)",borderWidth:2,data:dataValues,fill:"origin",pointBorderColor:"rgba("+colorRgb.r+", "+colorRgb.g+", "+colorRgb.b+", 1)",pointBackgroundColor:"white",pointBorderWidth:2}]};var options={legend:{display:false},plugins:{filler:{propagate:false}},elements:{line:{tension:0}},maintainAspectRatio:maintainAspectRatio};var chart=new Chart(elementId,{type:"line",data:data,options:options})}function showVisibleImages(images,offset){if(!images){return false}if(offset===undefined){offset=100}showVisibleImagesBase(images,true,offset)}function showVisibleImagesBase(images,checkIsScrolled,offset){images.each(function(){var img=$(this);var img_element=img.find("img");if(img_element.data("src")&&(!checkIsScrolled||isScrolledIntoView(img,offset))){img_element.attr("src",img_element.data("src"));img_element.data("src",null)}});images.find("img").on("load",function(){var img=$(this);if(!img.data("src")){img.fadeIn(500).removeClass("display-none")}})}function join_game(game_id){if(userId=="0"){showUnloggedInfo(vblang("logged.predictions"))}else{addUniversalDialog("join_game_dialog",vblang("dialog.join_game"),true,null,false);createUniversalDialogLoadContent("join_game_dialog",{game_id:game_id},"get_prediction_game_regulations")}}function installShowingAddWallpaper(){if(isMobile!="true"){$(".add-wallpaper-btn").hover(function(){$(this).addClass("wallpaper-hovered");$(this).fadeIn()},function(){$(this).removeClass("wallpaper-hovered")});$(".fanclub_stats_container:not(.added-wallpaper) .fanclub_stats, .fanclub_stats_container:not(.added-wallpaper) .fanclub_stats__max-width").hover(function(){$(this).closest(".fanclub_stats_container").find(".wallpaper-author:not(.wallpaper-author-added)").fadeIn()},function(e){if(!$(e.relatedTarget).hasClass("wallpaper-author")&&!$(e.relatedTarget).hasClass("fanclub_stats")&&!$(e.relatedTarget).hasClass("fanclub_stats__max-width")){$(this).closest(".fanclub_stats_container").find(".wallpaper-author:not(.wallpaper-author-added)").fadeOut()}});$(".wallpaper-author").hover(function(){$(this).closest(".fanclub_stats_container").find(".wallpaper-author:not(.wallpaper-author-added)").fadeIn()},function(e){if(!$(e.relatedTarget).hasClass("fanclub_stats")){$(this).closest(".fanclub_stats_container").find(".wallpaper-author:not(.wallpaper-author-added)").fadeOut()}})}}function openDialogAddRelation(itemId,itemGender){if(userId=="0"){showUnloggedInfo(vblang("logged.family"))}else{addUniversalDialog("add_relation_dialog",vblang("dialog.family"),true,null,false);createUniversalDialogLoadContent("add_relation_dialog",{},"get_add_relation_dialog/"+itemId+"/"+itemGender)}}function addRelation(input){var errorContainer=$("#add_relation_form .autocomplete-item-suggestions");$("#add_relation_form .formError").removeClass("formError");$("#add_relation_form").find("p.errors").remove();var data={type:input.closest("form").find('select[name="type"]').val()};addParametersToObject(input.closest("form"),data);addLoadingToButton(input,true);$.ajax({type:"POST",dataType:"json",url:basedir+"ajax/save_people_relation",data:data,success:function(data){if(data["code"]=="1"){input.closest("form").find(".button-close-dialog").trigger("click");$("#player-family-box").html(data["html"])}else{showReportDuplicateError(errorContainer,data["error"])}},error:function(){showReportDuplicateError(errorContainer,vblang("dialog.report_duplicate.error"))},complete:function(){addLoadingToButton(input,false)}})}function changeRelationStatus(input,status){var data={status:status,relation_id:input.data("id")};addLoadingToButton(input,true);$.ajax({type:"POST",url:basedir+"ajax/change_people_relation_status",data:data,success:function(data){$("#player-family-box").html(data)},error:function(){showInfoDialog(vblang("error.change_status"),vblang("dialog.error"))},complete:function(){addLoadingToButton(input,false)}})}function getShareDialog(dialog_title,item_type,item_id,url,show_transfers){var title=null;if($("h1").length>0){title=$.trim($("h1").first().text())}else{title=dialog_title}addUniversalDialog("share_dialog",dialog_title,true,null);createUniversalDialogLoadContent("share_dialog",{item_type:item_type,item_id:item_id,url:url,show_transfers:show_transfers,title:encodeURI(title)},"get_share_dialog")}function getAddSignatureDialog(btn){$.post(basedir+"ajax/get_add_signature_dialog",{id:btn.data("wallpaper-id")},function(data){var addSignatureDialog$=$("#add_signature_dialog");if(addSignatureDialog$.length>0){addSignatureDialog$.html(data);openDialog(addSignatureDialog$)}else{var signature_dialog=$("<div/>");signature_dialog.attr("id","add_signature_dialog");signature_dialog.html(data);signature_dialog.hide();$("body").append(signature_dialog);addUniversalDialogForElement(signature_dialog,vblang("dialog.picture_signature"),true,null,true)}})}function isSupportedMovieHost(link){var valid=true;if(link!==""){if(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/.test(link))valid=true;else if(/^(http(s)?:\/\/)?(www.)?vimeo.com\/([0-9]{6,9})/.test(link))valid=true;else if(/^(http(s)?:\/\/)?(www.)?dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/.test(link))valid=true;else if(/^(http(s)?:\/\/)?(www.)?facebook.com\/video.php\??v=?([^#\&\?]*)?/.test(link))valid=true;else if(/^(http(s)?:\/\/)?(www.)?facebook.com\/([^#\&\?]*)\/videos\/([0-9])*?/.test(link))valid=true;else if(/^(http(s)?:\/\/)?(www.)?streamable.com\/(.*)?/.test(link))valid=true;else valid=false}return valid}function initType(input){if(input.val()=="B"){$("select[name=t_type]").val("N");$("select[name=t_type]").attr("disabled","disabled")}else{$("select[name=t_type]").removeAttr("disabled")}}function initTournaments(callbackFunction){initType($("[name=t_ground]"));$("#teams_matches_select").empty();$("#match_details").empty();$("#tournament_matches_select").load(basedir+"ajax/get_tournament_ddslick_view",{type:$("select[name=t_type]").val(),gender:$("[name=t_gender]").val(),ground:$("[name=t_ground]").val(),age:$("select[name=t_age]").val()},function(){if(callbackFunction!=null){callbackFunction()}})}function installPlayerCurrentSeason(){if($(".stepsPlayers").length>0){addAutocompleteTriggers();$(".item_autocompleter").on("addNewItemEvent",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.clubs"))}else{addCreateClubDialog();createClubDialogLoadContent(null,null,$(".stepsPlayers").first().data("gender"),null)}});$(".currentRosterAddNewClubBtn").on("addedTransferEvent",function(){showInfoSaved($(this))})}}function showInfoSaved(input){input.closest(".stepsPlayers").children("div").hide();input.closest(".stepsPlayers").find(".informationSaved").show();input.closest(".stepsPlayers").closest(".dTableRow").slideUp();setTimeout(function(){var countryCode=input.closest(".stepsPlayers").find('input[name="teamCountry"]').val();if(countryCode){var currentCount=parseInt($("#country_count_"+countryCode).text(),10);if(currentCount>1){$("#country_count_"+countryCode).text(currentCount-1)}}},600)}function validateAddTournamentTeam(tournament_id,place){$("#add_tournament_container .item_autocompleter").css("border-color","");$("#add_tournament_container p.errors").remove();var valid=true;if(tournament_id==""||tournament_id=="0"||tournament_id=="-1"){$("#tournamentAutocompleter").css("border-color","red");$("#add_tournament_container").append('<p class="errors">'+vblang("tournament.required")+"</p>");valid=false}if(valid){var placeStr=place!=""?place:"0";var connectionIdStr=$("#add_tournament_container input[name=edited_connection]").val()!=""?$("#add_tournament_container input[name=edited_connection]").val():"-1";$.ajax({type:"POST",url:basedir+"ajax/if_correct_team_tournament/"+tournament_id+"/"+$(".item-profile").data("id")+"/"+placeStr+"/"+connectionIdStr,success:function(data){if(data>"0"){addTournamentTeam(false)}else if(data=="0"){$("#add_tournament_container select[name=place_id]").css("border-color","red");$("#tournamentAutocompleter").css("border-color","red");$("#add_tournament_container").append('<p class="errors">'+vblang("error.tournament_team.exists")+"</p>")}else if(data=="-1"){$("#add_tournament_container select[name=place_id]").css("border-color","red");$("#add_tournament_container").append('<p class="errors">'+vblang("error.tournament_team.place")+"</p>")}else if(data=="-2"){$("#tournamentAutocompleter").css("border-color","red");$("#add_tournament_container").append('<p class="errors">'+vblang("error.tournament_team.no_more")+"</p>")}}})}else{return valid}}function addTournamentTeam(doValidate){var tournament_id=$(".add_connection_cnt input[name=tournament_hid]").val();var place=$(".add_connection_cnt select[name=place_id]").val();var connection_id=$(".add_connection_cnt input[name=edited_connection]").val();if(!globalAddingConnection){globalLockUnlockSubmit(true);if(!doValidate||validateAddTournamentTeam(tournament_id,place)){$.ajax({type:"POST",url:basedir+"ajax/add_tournament_team",data:{tournament_id:tournament_id,team_id:$(".item-profile").data("id"),place:place,connection_id:connection_id,edit_confirmation:getEditConfirmationValue()},success:function(data){if(typeof data==="string"){data=JSON.parse(data)}if(data["code"]==1){refreshTab()}else{$(".add_connection_cnt").append('<p class="errors">'+data["error"]+"</p>")}globalLockUnlockSubmit(false)},error:function(){globalLockUnlockSubmit(false);showInfoDialog(vblang("error.common"),vblang("dialog.error"))}})}else{globalLockUnlockSubmit(false)}}}function showAddPhotoTrigger(){$("#add_photo_trigger_container").animate({bottom:"0px"},{duration:100,queue:false});$("#add_photo_trigger_container").addClass("add-photo-visible")}function hideAddPhotoTrigger(){$("#add_photo_trigger_container").animate({bottom:"-60px"},{duration:100,queue:false});$("#add_photo_trigger_container").removeClass("add-photo-visible")}function ifMovieCategoryExists(value){var exists=false;if(value!=""&&value!=0){$.ajax({url:basedir+"ajax/category_exists/"+value,data:{},async:false,success:function(msg){exists=msg==="1"}})}return exists}function installStarSelector(max){$(".stars-selector-container .rating .star").click(function(){var value=max-$(this).closest("li").find(".rating").children(".star").index(this);$(this).closest("li").find('input[type="hidden"]').val(value);$(this).closest("li").find(".star").each(function(){$(this).removeClass("active");$(this).removeClass("not-active")});$(this).addClass("active");$(this).nextAll(".star").each(function(){$(this).addClass("active")});changeStarValue($(this),value);$(this).closest("li").find("p.errors").remove()});$(".stars-selector-container .rating .star").hover(function(){$(this).closest(".rating").find(".star.active").each(function(){$(this).removeClass("active").addClass("not-active")});var value=max-$(this).closest("li").find(".rating").children(".star").index(this);changeStarValue($(this),value)},function(){$(this).closest(".rating").find(".star.not-active").each(function(){$(this).removeClass("not-active").addClass("active")});var i=0;$(this).closest("li").find(".rating").children(".star.active").each(function(){i++});changeStarValue($(this),i)})}function changeStarValue(input,value){input.closest(".rating").next(".stars_value_text").children("var").text(value)}function getEditConfirmationValue(){var value=null;var edit_confirmation$=$("#edit_confirmation");if(edit_confirmation$.length>0&&edit_confirmation$.is(":visible")){value=$.trim(edit_confirmation$.val())}return value}function getMatchView(){var edited_match=$('#add_match_form input[name="edited_match"]').val();if(edited_match&&edited_match!=""){var edited_match_box=$('.match_box[data-id="'+edited_match+'"]');$.ajax({type:"POST",url:basedir+"ajax/get_match_ajax",dataType:"html",data:{match_id:edited_match},success:function(response){var match_box_new=$("<div>").html(response).find('.match_box[data-id="'+edited_match+'"]');edited_match_box.replaceWith(match_box_new);$("#add_match_container").hide();installMatchBox(match_box_new,false);match_box_new.show();showVisibleImages($(".image-load-container"))}})}}function loadEmbeds(){if(document.querySelector("blockquote.twitter-tweet")&&!window.twttr){const script=document.createElement("script");script.src="https://platform.twitter.com/widgets.js";script.charset="utf-8";script.async=true;document.body.appendChild(script)}if(document.querySelector("blockquote.instagram-media")&&!window.instgrm){const script=document.createElement("script");script.src="//www.instagram.com/embed.js";script.async=true;document.body.appendChild(script)}if(document.querySelector(".fb-post")&&!window.FB){const script=document.createElement("script");script.src="https://connect.facebook.net/pl_PL/sdk.js#xfbml=1&version=v12.0";script.async=true;script.crossOrigin="anonymous";document.body.appendChild(script)}if(document.querySelector("blockquote.tiktok-embed")&&!window.tiktokEmbed){const script=document.createElement("script");script.src="https://www.tiktok.com/embed.js";script.async=true;document.body.appendChild(script)}}function ckeditorInstallOEmbedOnElement(element){while(element.firstChild){element.removeChild(element.firstChild)}element.style.backgroundImage=null;var anchor=document.createElement("a");anchor.setAttribute("href",element.dataset.oembedUrl);anchor.className="embedly-card";element.appendChild(anchor)}function showAddCommentForm(trigger_btn,callbackFunction){if(userId=="0"){showUnloggedInfo(vblang("logged.add_comment"))}else{trigger_btn.hide();script(basedirWithoutLang+"media/js/customized-ckeditor_v9.min.js?1.2",function(){$(".add-reply-form-container").removeClass("display-none");loadingGifOnElement($("#add_reply_form"),true);if(trigger_btn.closest(".add-comment-form").hasClass("add-comment-form-hidden-avatar")){trigger_btn.closest(".add-comment-form").find(".avatar").hide()}$("#add_reply_form").trigger("showFormEvent");if(callbackFunction!=null){callbackFunction()}})}}function installSavingRosterNumber(){$(document).on("change",".team-roster-table input[name='number']",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.player_number"));$(this).val("")}else{var input=$(this);var number=parseInt(input.val());if(number<1){return false}var season_id=input.closest(".team-roster-table").data("season-id");var type=input.closest(".team-roster-table").data("team-type");var connection_id=input.closest(".team-roster-row").data("id");$.ajax({type:"POST",url:basedir+"ajax/save_player_number",data:{number:number,season_id:season_id,type:type,connection_id:connection_id},success:function(response){if(response!="1"){input.val("")}}})}});$('.team-roster-table input[name="number"]').inputFilter(function(value){return/^\d*$/.test(value)})}function rejectPlayerNumber(connection_id){confirmFunction(vblang("confirm.delete_number"),function(){var is_national_tournament=$(".item-profile").data("type")=="O"&&$(".item-profile").data("tournament-type")=="N"?1:0;$.ajax({type:"POST",url:basedir+"ajax/remove_player_number",data:{number_connection_id:connection_id,is_national_tournament:is_national_tournament},success:function(){refreshTab()}})})}function showAddForSeasonForm(input){$("#cancel_button_hall").trigger("click");stdBtnChangeContent("add");addCloseTeamPlayerBtn(input);$("#playerAutocompleter").val("");$("input[name=player_hid]").val("");$("input[name=link]").val("");$("select[name=position]").val("");$("input[name=edited_connection]").val("");var add_player_container$=$("#add_player_container");add_player_container$.insertAfter(input.closest(".team-roster-header"));add_player_container$.toggle();add_player_container$.find("#cancel_button_hall").hide();add_player_container$.find(".season_container").hide();add_player_container$.find(".add-position-container").show();var season_id=input.closest(".team-roster-header").find('input[name="season_hid_id"]').val();if(season_id>=currentSeasonId){$("#add-player-link-container").show()}else{$("#add-player-link-container").hide()}$("[name=season_from]").val(season_id);$("[name=season_to]").val(season_id)}function addAdditionalParamsRosters(input){if($(".tournament-type-profile").length>0){$("input[name=team_hid]").val(input.closest(".team_roster").find("input[name=team_id_hid]").val());if($('#add_player_container input[name="type"]').val()=="N"){$('#add_player_container .autocomplete-parameters input[name="country"]').val(input.closest(".team_roster").data("country"))}}}var initializedAddingRosters=false;function installAddingRosters(){if(initializedAddingRosters){return false}initializedAddingRosters=true;$(document).on("click",".adding-player a",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.team_player"))}else{$("#add-player-trigger.clicked").trigger("click");$(".add-team-player-season.cancel-btn").not(this).each(function(){$(this).trigger("click")});showAddForSeasonForm($(this));addAdditionalParamsRosters($(this))}});$(document).on("click",".adding-staff a",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.team_staff"))}else{$("#add-player-trigger.clicked").trigger("click");$(".add-team-player-season.cancel-btn").not(this).each(function(){$(this).trigger("click")});addCloseTeamPlayerBtn($(this));addAdditionalParamsRosters($(this));$("#staffAutocompleter").val("");$("input[name=player_hid]").val("");$("input[name=link]").val("");$("input[name=edited_connection]").val("");var season_id=$(this).closest(".team-roster-header").find('input[name="season_hid_id"]').val();if(season_id>=currentSeasonId){$("#add-staff-link-container").show()}else{$("#add-staff-link-container").hide()}$("#add_staff_container").insertAfter($(this).closest(".team-roster-header"));$("#add_staff_container").toggle();$("#add_player_container").find(".season_container").hide();$("input[name=season_from]").val($(this).closest(".team-roster-header").find('input[name="season_hid_id"]').val());$("input[name=season_to]").val($(this).closest(".team-roster-header").find('input[name="season_hid_id"]').val())}})}function openPushPrePermissionDialog(question){if("Notification"in window&&isMobile=="true"&&Notification.permission!=="denied"&&Notification.permission!=="granted"&&userId!=0&&!ifAnyDialogIsOpen()&&getCookie("hide_push_pre_permissions")==null){addUniversalDialog("push_pre_perm_dialog",vblang("dialog.notifications.permission"),false,null);createUniversalDialogLoadContent("push_pre_perm_dialog",{question:question},"get_push_pre_permission_dialog");$("#push_pre_perm_dialog").closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove();$(document).on("click","#pre-permissions-cancel-btn",function(){setCookie("hide_push_pre_permissions",true,31);ga("send","event","Push permissions - rejected frontend",window.location.href,"Push permissions")});$(document).on("click","#pre-permissions-btn",function(){$("#push_pre_perm_dialog").dialog("close");ga("send","event","Push permissions - accepted frontend",window.location.href,"Push permissions");Notification.requestPermission().then(function(permission){if(permission==="granted"){ga("send","event","Push permissions - accepted FULL",window.location.href,"Push permissions")}else{ga("send","event","Push permissions - rejected FULL",window.location.href,"Push permissions")}})})}}function loadingGifOnElement(element,add){if(element.length>0){if(add){element.addClass("comments_transparent");var position_left=element.position()!=null?element.position().left:element.parent().position()?element.parent().position().left:null;var loader=$('<div data-text="'+vblang("global.loading")+'" />').addClass("comments-transparent-loader").width(element.outerWidth()).height(element.outerHeight()).css("left",position_left);$(loader).insertBefore(element)}else{element.removeClass("comments_transparent");element.find(".comments_transparent").removeClass("comments_transparent");element.find(".comments-transparent-loader").remove();element.parent().find(".comments-transparent-loader").remove()}}}function scrollToTop(){$("html, body").animate({scrollTop:0},200)}function script(url,callbackFunction){if($('script[src="'+url+'"]').length>0){var script=$('script[src="'+url+'"]');$("body").trigger("scriptLoaded");if(callbackFunction!=null){callbackFunction()}return script}else{var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src=url;if(callbackFunction!=null){s.onload=callbackFunction}var x=document.getElementsByTagName("head")[0];x.appendChild(s);return s}}function updateScrollbar(scrollbar){if(scrollbar!=null){scrollbar.update()}}function showAllMessagesReplies(btn){btn.hide();btn.closest(".new_box").find(".display-none").each(function(){$(this).removeClass("display-none")})}function showFinancialExpectations(player_id){if(userId=="0"){showUnloggedInfo(vblang("logged.expectations"))}else{addUniversalDialog("player_financial_expectations",vblang("logged.expectations.managers"),true,null,false);createUniversalDialogLoadContent("player_financial_expectations",{player_id:player_id},"get_player_financial_expectations")}}function preventNonNumericOnElement(input){input.on("keypress",function(e){return e.metaKey||e.which<=0||e.which==8||/[0-9]/.test(String.fromCharCode(e.which))})}function preventNonNumericOnElementNegative(input){input.on("keypress",function(e){const char=String.fromCharCode(e.which);const value=input.val();return e.metaKey||e.which<=0||e.which==8||/[0-9]/.test(char)||char==="-"&&value===""})}function openJobOfferSalary(){addUniversalDialog("job_offer_salary_dialog",vblang("logged.salary.claimed"),false,null);createUniversalDialogLoadContent("job_offer_salary_dialog",{},"get_job_offer_salary_dialog")}function showImage(btn_src){var $img=null;if($("#image-overlay").length<1){var $overlay=$("<div/>");$overlay.attr("id","image-overlay");$img=$("<img>").addClass("zoomed-image");$overlay.append($img);$("body").append($overlay)}$img=$(".zoomed-image").attr("src",btn_src);$("#image-overlay").addClass("open").one("click",function(){$("#image-overlay").removeClass("open")});if(isMobile=="true"){script(basedirWithoutLang+"media/js/magnifik.min.js?1.3",function(){$(".zoomed-image").magnifik({imageStyle:{position:"absolute",top:"50%",maxWidth:"none",maxHeight:"none",transform:"translateY(-50%)"}})})}}function installShowingRosterPhoto(){$(".team-roster-container img").on("load",function(){if(!$(this).data("src")){loadingGifOnElement($(this).closest(".team-roster-photo-container"),false)}})}function openEditWallpaperDialog(id){addUniversalDialog("edit_wallpaper_dialog",vblang("dialog.edit_wallpaper"),true,null,"400px");createUniversalDialogLoadContent("edit_wallpaper_dialog",{id:id},"get_edit_wallpaper_dialog")}function installAddingRosterPhoto(){$(".team-roster-container").each(function(){loadingGifOnElement($(this),true)});$(document).keyup(function(e){if(e.key==="Escape"&&$("#roster-overlay-container").length>0&&$("#roster-overlay-container").hasClass("open")){$(".roster-close-btn").click()}});installShowingRosterPhoto();showVisibleImages($(".team-roster-container"),250);$(document).scroll(function(){showVisibleImages($(".team-roster-container"),250)});$(document).on("click",".add-roster-photo-btn, .edit-roster-photo-btn",function(){if(userId=="0"){showUnloggedInfo(vblang("logged.roster_photo"))}else{var team_id=null;var season_id=null;var tournament_id=null;var photo_id=$(this).hasClass("edit-roster-photo-btn")?$(this).data("id"):null;if($(this).closest(".tournament-team-roster").length>0){team_id=$(this).closest(".tournament-team-roster").data("team-id");season_id=$(this).closest(".tournament-team-roster").data("season-id");tournament_id=$(this).closest(".tournament-team-roster").data("tournament-id")}else if($(this).closest(".season-box").length>0){team_id=$(this).closest(".season-box").data("team-id");season_id=$(this).closest(".season-box").data("season-id")}if(team_id!=null){createUniversalDialogLoadContent("add_roster_photo_dialog",{tournament_id:tournament_id,team_id:team_id,season_id:season_id,photo_id:photo_id},"get_add_roster_photo_dialog")}}})}function installDragFile(unloggedInfo,$form){$("html").on("dragover",function(e){e.preventDefault();e.stopPropagation()}).on("drop",function(e){e.preventDefault();e.stopPropagation()});$form.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault();e.stopPropagation()}).on("dragover dragenter",function(){$form.removeClass("is-error");$form.addClass("is-dragover")}).on("dragleave dragend drop",function(){$form.removeClass("is-dragover")}).on("drop",function(e){var file=e.originalEvent.dataTransfer.files;var fd=new FormData;fd.append("confirm_file",file[0]);dragReadFile(fd)});$(".drag-box__input label, .drag-box__icon").click(function(){if(userId=="0"){showUnloggedInfo(unloggedInfo)}else{$("#confirm-pro-file").click()}});$("#confirm-pro-file").change(function(){var fd=new FormData;var files=$("#confirm-pro-file")[0].files[0];fd.append("confirm_file",files);dragReadFile(fd)})}function showCreatePostDialog(item_id,item_type,back_url){if(userId=="0"){showUnloggedInfo(vblang("logged.add_something"))}else{if(!back_url){back_url=$("body").data("url")}$(".add-post-container").load(basedir+"ajax/get_add_item_dialog",{tabName:"post",item_id:item_id,item_type:item_type!=""?item_type:null,back_url:back_url})}}function getTeamRosterFullScreen(image_src,team_id,season_id,tournament_id){$("#roster-overlay-container").remove();var $overlay=$("<div/>");$overlay.attr("id","roster-image-overlay");var $img=$("<img>").addClass("zoomed-image");$img.attr("src",image_src);var $rightPane=$("<div>").addClass("right-pane");var $closeButton=$("<button/>");$closeButton.addClass("roster-close-btn");$closeButton.attr("title","Close");$closeButton.append('<i class="fal fa-times"></i>');var $overlayContainer=$("<div/>");$overlayContainer.attr("id","roster-image-container");$overlayContainer.append($img);$overlay.append($overlayContainer);var $overlayContainer=$("<div/>");$overlayContainer.attr("id","roster-overlay-container");$overlayContainer.append($overlay).append($rightPane).append($closeButton);$("body").append($overlayContainer);$("body").addClass("stop-scrolling");loadingGifOnElement($rightPane,true);$.ajax({type:"POST",url:basedir+"ajax/get_tournament_team_roster_pane",data:{team_id:team_id,tournament_id:tournament_id,season_id:season_id,position:"ALL"},success:function(data){loadingGifOnElement($rightPane,false);$rightPane.html(data);new PerfectScrollbar("#roster-overlay-container .right-pane",{wheelPropagation:false,suppressScrollX:true})}});$closeButton.click(function(){$("#roster-overlay-container").removeClass("open");$("body").removeClass("stop-scrolling");var currentUrl=window.location.href;refreshBrowserUrl(currentUrl.substr(0,currentUrl.indexOf("#")))});$overlay.click(function(e){if(e.target!=this)return;$closeButton.click()});$("#roster-overlay-container").addClass("open")}function hexToRgb(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null}function getProfileViews(itemId,itemType){addUniversalDialog("profile_views_dialog",vblang("dialog.profile_views"),true,null);createUniversalDialogLoadContent("profile_views_dialog",{item_id:itemId,item_type:itemType},"get_profile_views_dialog")}function openReportRelation(reportId){addUniversalDialog("report_relation_dialog",vblang("dialog.incorrect_family"),true,null);createUniversalDialogLoadContent("report_relation_dialog",{report_id:reportId},"get_report_relation_dialog")}function showAddTournamentForSeasonForm(input){if(userId=="0"){showUnloggedInfo(vblang("logged.tournament_team"))}else{$(".add-team-player-season.cancel-btn").not(input).each(function(){$(this).trigger("click")});stdBtnChangeContent("add");addCloseTeamPlayerBtn(input);$("#tournamentAutocompleter").val("");$("input[name=tournament_hid]").val("");$("select[name=place_id]").val("");$("input[name=edited_connection]").val("");$("#add_tournament_container").insertBefore(input.closest(".club-tournaments-container"));$("#add_tournament_container").toggleClass("display-none");$("#add_tournament_container").find("#cancel_button_hall").hide();var season_id=input.closest(".season-box").data("season-id");$("#add_tournament_container [name=season_id]").val(season_id)}}function openRecommendationDialog(playerId){addUniversalDialog("recommendation_dialog",vblang("dialog.add_recommendation"),true,null);createUniversalDialogLoadContent("recommendation_dialog",{player_id:playerId},"get_recommendation_dialog")}function toggleTooltipList(btn){if(btn.find(".dd-menu").is(":visible")){btn.find(".dd-menu").slideUp()}else{btn.find(".dd-menu").slideDown()}}function getTransfersWidget(){addUniversalDialog("get_transfers_widget",vblang("dialog.transfers_widget"),true,null,false);createUniversalDialogLoadContent("get_transfers_widget",{},"get_generate_widget")}function set_lang(lang,link,e){e.preventDefault();setCookie("lang",lang,3650);window.location.href=link.attr("href")}function resample_single(canvas,width,height,resize_canvas){if(!canvas){return false}var width_source=canvas.width;if(width_source==0){return false}var height_source=canvas.height;width=Math.round(width);height=Math.round(height);var ratio_w=width_source/width;var ratio_h=height_source/height;var ratio_w_half=Math.ceil(ratio_w/2);var ratio_h_half=Math.ceil(ratio_h/2);var ctx=canvas.getContext("2d");var img=ctx.getImageData(0,0,width_source,height_source);var img2=ctx.createImageData(width,height);var data=img.data;var data2=img2.data;for(var j=0;j<height;j++){for(var i=0;i<width;i++){var x2=(i+j*width)*4;var weight=0;var weights=0;var weights_alpha=0;var gx_r=0;var gx_g=0;var gx_b=0;var gx_a=0;var center_y=(j+.5)*ratio_h;var yy_start=Math.floor(j*ratio_h);var yy_stop=Math.ceil((j+1)*ratio_h);for(var yy=yy_start;yy<yy_stop;yy++){var dy=Math.abs(center_y-(yy+.5))/ratio_h_half;var center_x=(i+.5)*ratio_w;var w0=dy*dy;var xx_start=Math.floor(i*ratio_w);var xx_stop=Math.ceil((i+1)*ratio_w);for(var xx=xx_start;xx<xx_stop;xx++){var dx=Math.abs(center_x-(xx+.5))/ratio_w_half;var w=Math.sqrt(w0+dx*dx);if(w>=1){continue}weight=2*w*w*w-3*w*w+1;var pos_x=4*(xx+yy*width_source);gx_a+=weight*data[pos_x+3];weights_alpha+=weight;if(data[pos_x+3]<255)weight=weight*data[pos_x+3]/250;gx_r+=weight*data[pos_x];gx_g+=weight*data[pos_x+1];gx_b+=weight*data[pos_x+2];weights+=weight}}data2[x2]=gx_r/weights;data2[x2+1]=gx_g/weights;data2[x2+2]=gx_b/weights;data2[x2+3]=gx_a/weights_alpha}}if(resize_canvas===true){canvas.width=width;canvas.height=height}else{ctx.clearRect(0,0,width_source,height_source)}ctx.putImageData(img2,0,0)}function saveSponsoredPopupOption(step,variant){setCookie("dialog_"+$("#sponsored-dialog").data("title"),true,120);$.ajax({url:basedir+"ajax/save_sponsored_popup_asw",data:{step:step,variant:variant},type:"POST",async:true,success:function(){}})}function openSponsoredPopup(title,step){addUniversalDialog("sponsored-dialog-container",vblang("favorites.choose"),false,"sponsoredPopup","800px");createUniversalDialogLoadContent("sponsored-dialog-container",{title:title,step:step},"get_sponsored_popup");$("#sponsored-dialog-container").dialog("option","closeOnEscape",false);if(step==2){saveSponsoredPopupOption(1,null)}else{$("#sponsored-dialog-container").siblings(".ui-dialog-titlebar").hide()}}function installGettingPlayerPosition(){$("#playerAutocompleter").on("selectedItemEvent",function(){const $add_player_form=$(this).closest(".add-player-form");const $chosen_player=$add_player_form.find('input[name="player_hid"]').val();const $position_element=$add_player_form.find("select[name=position]");if($position_element.val()==""&&$chosen_player){$.ajax({type:"POST",url:basedir+"ajax/get_player_position",data:{player_id:$chosen_player},success:function(response){if($("response code",response).text()=="1"){$position_element.val($("response position",response).text())}}})}})}function removeAppliedFilter(button){const baseInput$=$(`[name="${button.data("input-name")}"]`);if(baseInput$.length){if(baseInput$.is('input[type="checkbox"]')){baseInput$.click();refreshItemsList(null,false,null,true)}else{const inputs$=$(`[name="${button.data("input-name")}"]`).closest(".search-filter").find("input,select");if(inputs$.length){inputs$.each(function(){if($(this).is('input[type="checkbox"]')){$(this).click()}else{$(this).val("")}});refreshItemsList(null,false,null,true)}}}}function processAppliedFilter(inputElement$,filterName,buttonTemplate){let filterValue=inputElement$.val();let filterText;if(inputElement$.is('input[type="hidden"]')){filterText=inputElement$.siblings('input[type="text"]').val()}else if(inputElement$.is('input[type="checkbox"]')){filterText=inputElement$.siblings(`.checkbox-switch-next-label[for="${inputElement$.attr("name")}"]`).text();if(!inputElement$.is(":checked")){filterValue=null}}else if(inputElement$.is("input")){filterText=filterValue}else{filterText=inputElement$.find("option:selected").text()}if(filterValue&&filterValue!="0"&&inputElement$.attr("id")!="gender_switcher"){const filterButton=buttonTemplate.clone();let buttonText;if(filterName){buttonText=`${$.trim(filterName)}: <b>${$.trim(filterText)}</b>`}else{buttonText=`<b>${$.trim(filterText)}</b>`}filterButton.find("span").html(buttonText);filterButton.data("input-name",inputElement$.attr("name"));$(".applied-filters").append(filterButton);$(".applied-filters").removeClass("display-none")}}function refreshAppliedFilters(){const buttonTemplate=$(".applied-filters button").first().clone();buttonTemplate.removeClass("v-hidden");$(".applied-filters button").not(".v-hidden").remove();$(".main_dropdowns_lists .search-filter:not(.search-filter-checkboxes):not(.skip-applied)").each(function(){const filterName=$(this).find(".search-filter-header").text();const inputElements$=$(this).find("input[name],select[name]");if(inputElements$.length){const inputElement$=inputElements$.first();processAppliedFilter(inputElement$,filterName,buttonTemplate)}});$('.main_dropdowns_lists .search-filter.search-filter-checkboxes input[type="checkbox"]').each(function(){processAppliedFilter($(this),null,buttonTemplate)});$(".applied-filters").append($(".applied-filters button.v-hidden"))}function installAppliedFilters(){refreshAppliedFilters();$(".ajax-loaded-list").on("refreshAjaxItemListEvent",function(){refreshAppliedFilters()})}function editNativeNames(item_id,item_type,is_alphabet,wide){if(userId=="0"){showUnloggedInfo($("#native-names-section").data("only-logged-msg"))}else{addUniversalDialog("edit_native_names",$("#native-names-section").data("add-msg"),true,null,wide?1094:800);createUniversalDialogLoadContent("edit_native_names",{item_id:item_id,item_type:item_type,is_alphabet:is_alphabet,item_name:$(".item-profile").data("original-name")},"get_native_names_dialog")}}function editHistoricalNames(item_id){if(userId=="0"){showUnloggedInfo(vblang("logged.edit_historical"))}else{addUniversalDialog("edit_historical_names",vblang("dialog.edit_historical"),true,null,1094);createUniversalDialogLoadContent("edit_historical_names",{item_id:item_id,item_name:$(".item-profile").data("name"),item_type:$(".item-profile").data("type")},"get_historical_names_dialog")}}